SLURM_JOB_ID: 61291692
SLURM_JOB_USER: vsc36378
SLURM_JOB_ACCOUNT: lp_wice_pilot
SLURM_JOB_NAME: train_bert_cls.slurm
SLURM_CLUSTER_NAME: wice
SLURM_JOB_PARTITION: gpu_h100
SLURM_NNODES: 1
SLURM_NODELIST: s16g12
SLURM_JOB_CPUS_PER_NODE: 18
SLURM_JOB_GPUS: 0
Date: Sat Mar 30 20:46:13 CET 2024
Walltime: 00-00:30:00
========================================================================
no change     /apps/leuven/rocky8/skylake/2021a/software/Miniconda3/4.12.0/condabin/conda
no change     /apps/leuven/rocky8/skylake/2021a/software/Miniconda3/4.12.0/bin/conda
no change     /apps/leuven/rocky8/skylake/2021a/software/Miniconda3/4.12.0/bin/conda-env
no change     /apps/leuven/rocky8/skylake/2021a/software/Miniconda3/4.12.0/bin/activate
no change     /apps/leuven/rocky8/skylake/2021a/software/Miniconda3/4.12.0/bin/deactivate
no change     /apps/leuven/rocky8/skylake/2021a/software/Miniconda3/4.12.0/etc/profile.d/conda.sh
no change     /apps/leuven/rocky8/skylake/2021a/software/Miniconda3/4.12.0/etc/fish/conf.d/conda.fish
no change     /apps/leuven/rocky8/skylake/2021a/software/Miniconda3/4.12.0/shell/condabin/Conda.psm1
no change     /apps/leuven/rocky8/skylake/2021a/software/Miniconda3/4.12.0/shell/condabin/conda-hook.ps1
no change     /apps/leuven/rocky8/skylake/2021a/software/Miniconda3/4.12.0/lib/python3.8/site-packages/xontrib/conda.xsh
no change     /apps/leuven/rocky8/skylake/2021a/software/Miniconda3/4.12.0/etc/profile.d/conda.csh
no change     /user/leuven/363/vsc36378/.bashrc
No action taken.
Python 3.12.0
Requirement already satisfied: accelerate==0.28.0 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 1)) (0.28.0)
Requirement already satisfied: aiohttp==3.9.3 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 2)) (3.9.3)
Requirement already satisfied: aiosignal==1.3.1 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 3)) (1.3.1)
Requirement already satisfied: async-timeout==4.0.3 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 4)) (4.0.3)
Requirement already satisfied: attrs==23.2.0 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 5)) (23.2.0)
Requirement already satisfied: certifi==2024.2.2 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 6)) (2024.2.2)
Requirement already satisfied: charset-normalizer==3.3.2 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 7)) (3.3.2)
Requirement already satisfied: click==8.1.7 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 8)) (8.1.7)
Requirement already satisfied: datasets==2.18.0 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 9)) (2.18.0)
Requirement already satisfied: dill==0.3.8 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 10)) (0.3.8)
Requirement already satisfied: filelock==3.13.1 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 11)) (3.13.1)
Requirement already satisfied: frozenlist==1.4.1 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 12)) (1.4.1)
Requirement already satisfied: fsspec==2024.2.0 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 13)) (2024.2.0)
Requirement already satisfied: huggingface-hub==0.21.4 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 14)) (0.21.4)
Requirement already satisfied: idna==3.6 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 15)) (3.6)
Requirement already satisfied: imbalanced-learn==0.12.0 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 16)) (0.12.0)
Requirement already satisfied: Jinja2==3.1.3 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 17)) (3.1.3)
Requirement already satisfied: joblib==1.3.2 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 18)) (1.3.2)
Requirement already satisfied: MarkupSafe==2.1.5 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 19)) (2.1.5)
Requirement already satisfied: mpmath==1.3.0 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 20)) (1.3.0)
Requirement already satisfied: multidict==6.0.5 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 21)) (6.0.5)
Requirement already satisfied: multiprocess==0.70.16 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 22)) (0.70.16)
Requirement already satisfied: networkx==3.2.1 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 23)) (3.2.1)
Requirement already satisfied: nltk==3.8.1 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 24)) (3.8.1)
Requirement already satisfied: numpy==1.26.4 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 25)) (1.26.4)
Requirement already satisfied: nvidia-cublas-cu12==12.1.3.1 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 26)) (12.1.3.1)
Requirement already satisfied: nvidia-cuda-cupti-cu12==12.1.105 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 27)) (12.1.105)
Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.1.105 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 28)) (12.1.105)
Requirement already satisfied: nvidia-cuda-runtime-cu12==12.1.105 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 29)) (12.1.105)
Requirement already satisfied: nvidia-cudnn-cu12==8.9.2.26 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 30)) (8.9.2.26)
Requirement already satisfied: nvidia-cufft-cu12==11.0.2.54 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 31)) (11.0.2.54)
Requirement already satisfied: nvidia-curand-cu12==10.3.2.106 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 32)) (10.3.2.106)
Requirement already satisfied: nvidia-cusolver-cu12==11.4.5.107 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 33)) (11.4.5.107)
Requirement already satisfied: nvidia-cusparse-cu12==12.1.0.106 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 34)) (12.1.0.106)
Requirement already satisfied: nvidia-nccl-cu12==2.19.3 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 35)) (2.19.3)
Requirement already satisfied: nvidia-nvjitlink-cu12==12.4.99 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 36)) (12.4.99)
Requirement already satisfied: nvidia-nvtx-cu12==12.1.105 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 37)) (12.1.105)
Requirement already satisfied: packaging==24.0 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 38)) (24.0)
Requirement already satisfied: pandas==2.2.1 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 39)) (2.2.1)
Requirement already satisfied: psutil==5.9.8 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 40)) (5.9.8)
Requirement already satisfied: pyarrow==15.0.1 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 41)) (15.0.1)
Requirement already satisfied: pyarrow-hotfix==0.6 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 42)) (0.6)
Requirement already satisfied: python-dateutil==2.9.0.post0 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 43)) (2.9.0.post0)
Requirement already satisfied: pytz==2024.1 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 44)) (2024.1)
Requirement already satisfied: PyYAML==6.0.1 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 45)) (6.0.1)
Requirement already satisfied: regex==2023.12.25 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 46)) (2023.12.25)
Requirement already satisfied: requests==2.31.0 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 47)) (2.31.0)
Requirement already satisfied: safetensors==0.4.2 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 48)) (0.4.2)
Requirement already satisfied: scikit-learn==1.4.1.post1 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 49)) (1.4.1.post1)
Requirement already satisfied: scipy==1.12.0 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 50)) (1.12.0)
Requirement already satisfied: setuptools==68.2.2 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 51)) (68.2.2)
Requirement already satisfied: six==1.16.0 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 52)) (1.16.0)
Requirement already satisfied: sympy==1.12 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 53)) (1.12)
Requirement already satisfied: threadpoolctl==3.3.0 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 54)) (3.3.0)
Requirement already satisfied: tokenizers==0.15.2 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 55)) (0.15.2)
Requirement already satisfied: torch==2.2.0 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 56)) (2.2.0)
Requirement already satisfied: tqdm==4.66.2 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 57)) (4.66.2)
Requirement already satisfied: transformers==4.38.2 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 58)) (4.38.2)
Requirement already satisfied: typing_extensions==4.10.0 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 59)) (4.10.0)
Requirement already satisfied: tzdata==2024.1 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 60)) (2024.1)
Requirement already satisfied: urllib3==2.2.1 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 61)) (2.2.1)
Requirement already satisfied: wheel==0.41.2 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 62)) (0.41.2)
Requirement already satisfied: xxhash==3.4.1 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 63)) (3.4.1)
Requirement already satisfied: yarl==1.9.4 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from -r requirements.txt (line 64)) (1.9.4)
Requirement already satisfied: triton==2.2.0 in /scratch/leuven/363/vsc36378/envs/jobs_env/lib/python3.12/site-packages (from torch==2.2.0->-r requirements.txt (line 56)) (2.2.0)
[nltk_data] Downloading package stopwords to
[nltk_data]     /user/leuven/363/vsc36378/nltk_data...
[nltk_data]   Package stopwords is already up-to-date!
[nltk_data] Downloading package wordnet to
[nltk_data]     /user/leuven/363/vsc36378/nltk_data...
[nltk_data]   Package wordnet is already up-to-date!
features: title + content
Map:   0%|          | 0/36 [00:00<?, ? examples/s]Token indices sequence length is longer than the specified maximum sequence length for this model (2786 > 512). Running this sequence through the model will result in indexing errors
Map:  42%|████▏     | 15/36 [00:00<00:00, 108.25 examples/s]Map:  78%|███████▊  | 28/36 [00:00<00:00, 105.57 examples/s]Map: 100%|██████████| 36/36 [00:00<00:00, 108.08 examples/s]
Map:   0%|          | 0/642 [00:00<?, ? examples/s]Map:   2%|▏         | 13/642 [00:00<00:04, 125.97 examples/s]Map:   5%|▍         | 29/642 [00:00<00:04, 131.04 examples/s]Map:   8%|▊         | 49/642 [00:00<00:04, 140.93 examples/s]Map:  10%|█         | 67/642 [00:00<00:04, 124.04 examples/s]Map:  13%|█▎        | 83/642 [00:00<00:04, 134.03 examples/s]Map:  15%|█▌        | 98/642 [00:00<00:04, 134.39 examples/s]Map:  18%|█▊        | 113/642 [00:00<00:03, 134.62 examples/s]Map:  21%|██        | 133/642 [00:01<00:03, 132.25 examples/s]Map:  24%|██▎       | 151/642 [00:01<00:03, 123.85 examples/s]Map:  26%|██▋       | 170/642 [00:01<00:04, 114.19 examples/s]Map:  29%|██▉       | 188/642 [00:01<00:03, 127.75 examples/s]Map:  32%|███▏      | 205/642 [00:01<00:04, 104.44 examples/s]Map:  34%|███▍      | 217/642 [00:01<00:04, 104.89 examples/s]Map:  36%|███▌      | 232/642 [00:01<00:03, 113.35 examples/s]Map:  39%|███▉      | 250/642 [00:02<00:03, 111.42 examples/s]Map:  41%|████      | 264/642 [00:02<00:03, 116.59 examples/s]Map:  44%|████▍     | 284/642 [00:02<00:02, 132.08 examples/s]Map:  47%|████▋     | 301/642 [00:02<00:02, 120.80 examples/s]Map:  49%|████▉     | 316/642 [00:02<00:02, 124.24 examples/s]Map:  52%|█████▏    | 336/642 [00:02<00:02, 110.50 examples/s]Map:  55%|█████▌    | 356/642 [00:02<00:02, 124.65 examples/s]Map:  58%|█████▊    | 374/642 [00:03<00:01, 134.02 examples/s]Map:  62%|██████▏   | 396/642 [00:03<00:01, 125.64 examples/s]Map:  64%|██████▍   | 412/642 [00:03<00:01, 129.28 examples/s]Map:  68%|██████▊   | 437/642 [00:03<00:01, 135.48 examples/s]Map:  71%|███████   | 454/642 [00:03<00:01, 125.32 examples/s]Map:  73%|███████▎  | 471/642 [00:03<00:01, 134.02 examples/s]Map:  77%|███████▋  | 492/642 [00:04<00:01, 78.14 examples/s] Map:  79%|███████▉  | 508/642 [00:04<00:01, 87.79 examples/s]Map:  81%|████████▏ | 523/642 [00:04<00:01, 98.03 examples/s]Map:  85%|████████▍ | 544/642 [00:04<00:00, 104.25 examples/s]Map:  87%|████████▋ | 559/642 [00:04<00:00, 109.07 examples/s]Map:  90%|█████████ | 581/642 [00:04<00:00, 117.40 examples/s]Map:  93%|█████████▎| 598/642 [00:05<00:00, 112.13 examples/s]Map:  95%|█████████▌| 610/642 [00:05<00:00, 112.58 examples/s]Map:  98%|█████████▊| 629/642 [00:05<00:00, 128.35 examples/s]Map: 100%|██████████| 642/642 [00:05<00:00, 115.27 examples/s]
Map:   0%|          | 0/664 [00:00<?, ? examples/s]Map:   2%|▏         | 14/664 [00:00<00:05, 121.89 examples/s]Map:   5%|▌         | 34/664 [00:00<00:05, 110.27 examples/s]Map:   8%|▊         | 50/664 [00:00<00:05, 111.04 examples/s]Map:  11%|█         | 70/664 [00:00<00:04, 134.32 examples/s]Map:  14%|█▍        | 92/664 [00:00<00:06, 83.90 examples/s] Map:  16%|█▋        | 108/664 [00:01<00:05, 96.53 examples/s]Map:  19%|█▊        | 124/664 [00:01<00:04, 108.12 examples/s]Map:  22%|██▏       | 145/664 [00:01<00:04, 124.91 examples/s]Map:  24%|██▍       | 160/664 [00:01<00:04, 124.48 examples/s]Map:  27%|██▋       | 176/664 [00:01<00:03, 130.05 examples/s]Map:  29%|██▉       | 194/664 [00:01<00:04, 102.30 examples/s]Map:  32%|███▏      | 210/664 [00:01<00:04, 112.02 examples/s]Map:  34%|███▎      | 224/664 [00:02<00:03, 113.97 examples/s]Map:  36%|███▌      | 240/664 [00:02<00:03, 123.37 examples/s]Map:  39%|███▊      | 256/664 [00:02<00:03, 104.37 examples/s]Map:  40%|████      | 268/664 [00:02<00:03, 104.01 examples/s]Map:  43%|████▎     | 286/664 [00:02<00:03, 119.75 examples/s]Map:  45%|████▌     | 300/664 [00:02<00:03, 121.23 examples/s]Map:  48%|████▊     | 319/664 [00:02<00:02, 118.66 examples/s]Map:  50%|█████     | 335/664 [00:03<00:03, 108.48 examples/s]Map:  52%|█████▏    | 347/664 [00:03<00:02, 106.96 examples/s]Map:  55%|█████▌    | 366/664 [00:03<00:02, 123.07 examples/s]Map:  57%|█████▋    | 381/664 [00:03<00:02, 110.69 examples/s]Map:  59%|█████▉    | 395/664 [00:03<00:02, 114.59 examples/s]Map:  62%|██████▏   | 410/664 [00:03<00:02, 120.76 examples/s]Map:  64%|██████▍   | 427/664 [00:03<00:01, 128.78 examples/s]Map:  67%|██████▋   | 445/664 [00:03<00:01, 124.44 examples/s]Map:  69%|██████▉   | 459/664 [00:03<00:01, 125.17 examples/s]Map:  71%|███████▏  | 474/664 [00:04<00:01, 128.10 examples/s]Map:  74%|███████▍  | 491/664 [00:04<00:01, 137.25 examples/s]Map:  76%|███████▋  | 507/664 [00:04<00:01, 139.05 examples/s]Map:  79%|███████▊  | 522/664 [00:04<00:01, 140.54 examples/s]Map:  81%|████████▏ | 541/664 [00:04<00:00, 153.33 examples/s]Map:  84%|████████▍ | 557/664 [00:04<00:00, 153.73 examples/s]Map:  86%|████████▋ | 573/664 [00:04<00:00, 132.53 examples/s]Map:  90%|████████▉ | 597/664 [00:04<00:00, 136.91 examples/s]Map:  92%|█████████▏| 614/664 [00:05<00:00, 90.63 examples/s] Map:  95%|█████████▌| 631/664 [00:05<00:00, 103.14 examples/s]Map:  97%|█████████▋| 647/664 [00:05<00:00, 111.10 examples/s]Map:  99%|█████████▉| 660/664 [00:05<00:00, 112.67 examples/s]Map: 100%|██████████| 664/664 [00:05<00:00, 114.90 examples/s]
DatasetDict({
    train: Dataset({
        features: ['features', 'labels', 'input_ids', 'attention_mask'],
        num_rows: 36
    })
    test: Dataset({
        features: ['features', 'labels', 'input_ids', 'attention_mask'],
        num_rows: 642
    })
    valid: Dataset({
        features: ['features', 'labels', 'input_ids', 'attention_mask'],
        num_rows: 664
    })
})
class_weights: [4.        0.75      0.7058824]
Training and validating model
------------------------- Epoch 1 -------------------------
tensor([[  101,  3513, 23802,  ...,  2092,  1011,   102],
        [  101, 10959,  2000,  ...,  7300, 13965,   102],
        [  101,  1011, 13115,  ..., 19153,  1998,   102],
        ...,
        [  101,  1012,  2009,  ...,  2138,  2057,   102],
        [  101,  2024,  2092,  ..., 17258,  9259,   102],
        [  101,  3303,  3571,  ..., 16939,  1010,   102]], device='cuda:0')
tensor([2, 1, 0, 1, 2, 1, 0, 1], device='cuda:0')
logits tensor([[-0.0444, -0.0964,  0.2265],
        [ 0.0679, -0.0979,  0.0878],
        [-0.0011, -0.2303,  0.1281],
        [ 0.0258, -0.1575,  0.4006],
        [-0.1559, -0.1248, -0.0316],
        [-0.1238, -0.2400,  0.0973],
        [-0.2479, -0.0279,  0.0350],
        [-0.0639, -0.1691,  0.1460],
        [-0.1778, -0.0554,  0.1186],
        [ 0.0457, -0.2238,  0.1101],
        [-0.0122, -0.1893,  0.2232],
        [-0.0225, -0.1350,  0.3002],
        [ 0.0283, -0.1473,  0.1517],
        [-0.0166, -0.1354,  0.2079],
        [-0.0301, -0.1060,  0.1621],
        [-0.0557, -0.1318,  0.2676],
        [ 0.0174,  0.0848,  0.2523],
        [-0.0836, -0.0866,  0.1010],
        [-0.0125, -0.1744,  0.2168],
        [ 0.0309, -0.1928,  0.2093],
        [ 0.0351, -0.0523,  0.3067],
        [-0.0289,  0.0165,  0.1163],
        [-0.0301, -0.1731,  0.1381],
        [ 0.1706, -0.1476,  0.1497],
        [-0.0756, -0.2760,  0.2184],
        [-0.1003, -0.2790,  0.2525],
        [-0.0450, -0.0690,  0.1502],
        [-0.0357, -0.1907,  0.1604],
        [-0.1891, -0.2608,  0.3457],
        [-0.0992, -0.2971,  0.1559],
        [-0.0163, -0.2098,  0.2148],
        [-0.0339, -0.3341,  0.1961],
        [-0.2152, -0.2532,  0.3399],
        [ 0.0883, -0.0774,  0.2437],
        [ 0.0438, -0.3038,  0.3318],
        [ 0.2261, -0.1152,  0.3867],
        [ 0.0118, -0.2400,  0.3065],
        [-0.0612, -0.1479,  0.2774],
        [ 0.1316, -0.2024,  0.3371],
        [ 0.1062, -0.2358,  0.3261],
        [ 0.0738, -0.1605,  0.2048],
        [ 0.0373, -0.2506,  0.3682],
        [ 0.1284, -0.1591,  0.3293],
        [-0.1195, -0.0986,  0.2262],
        [-0.1074, -0.1136,  0.2643],
        [ 0.0580,  0.0024,  0.3003],
        [ 0.0565, -0.1935,  0.2633],
        [ 0.1482, -0.2070,  0.1495],
        [ 0.0522, -0.2124,  0.1986],
        [-0.0393, -0.1318,  0.1560],
        [ 0.1121, -0.0414,  0.3328],
        [-0.0140, -0.0945,  0.2842],
        [ 0.1998, -0.1750,  0.1734],
        [-0.0299, -0.1254,  0.2616],
        [ 0.1024, -0.0991,  0.1805],
        [ 0.0225, -0.0939,  0.2308],
        [-0.0107,  0.0228,  0.3110],
        [-0.0697, -0.2402,  0.1067],
        [-0.0016, -0.0750,  0.1905],
        [-0.0156, -0.0944,  0.1495],
        [ 0.0559,  0.0336,  0.1212],
        [-0.1769, -0.1051,  0.1465],
        [ 0.0579, -0.1739,  0.0908],
        [ 0.0009, -0.0145,  0.1136],
        [-0.0373, -0.0584,  0.2224],
        [-0.0197, -0.0642,  0.0095],
        [ 0.0078, -0.0737,  0.2441],
        [-0.0365, -0.0096,  0.0419],
        [ 0.0466, -0.1133,  0.2267],
        [-0.0603, -0.2138,  0.1123],
        [-0.0038, -0.0239,  0.1629],
        [-0.0931, -0.1111,  0.1667],
        [ 0.0112, -0.0576,  0.1286],
        [-0.0432, -0.0981,  0.2903],
        [ 0.0059, -0.1251,  0.2226],
        [ 0.0182, -0.1500,  0.2955],
        [-0.1648, -0.0258,  0.2421],
        [-0.0019, -0.0511,  0.1107],
        [-0.0481, -0.1384,  0.2409],
        [ 0.0897, -0.1171,  0.4227],
        [-0.0269, -0.2564,  0.2579],
        [-0.0883, -0.1168,  0.1716],
        [ 0.0024, -0.3137,  0.3239],
        [ 0.0095, -0.1541,  0.2859],
        [-0.1855, -0.1529,  0.1360],
        [-0.0324, -0.1985,  0.1454],
        [-0.1060, -0.1464,  0.1549],
        [-0.0550, -0.2957,  0.2498]], device='cuda:0',
       grad_fn=<AddmmBackward0>)
logits_split (tensor([[-0.0444, -0.0964,  0.2265],
        [ 0.0679, -0.0979,  0.0878],
        [-0.0011, -0.2303,  0.1281],
        [ 0.0258, -0.1575,  0.4006],
        [-0.1559, -0.1248, -0.0316],
        [-0.1238, -0.2400,  0.0973],
        [-0.2479, -0.0279,  0.0350],
        [-0.0639, -0.1691,  0.1460],
        [-0.1778, -0.0554,  0.1186],
        [ 0.0457, -0.2238,  0.1101],
        [-0.0122, -0.1893,  0.2232],
        [-0.0225, -0.1350,  0.3002],
        [ 0.0283, -0.1473,  0.1517],
        [-0.0166, -0.1354,  0.2079],
        [-0.0301, -0.1060,  0.1621],
        [-0.0557, -0.1318,  0.2676],
        [ 0.0174,  0.0848,  0.2523],
        [-0.0836, -0.0866,  0.1010],
        [-0.0125, -0.1744,  0.2168],
        [ 0.0309, -0.1928,  0.2093],
        [ 0.0351, -0.0523,  0.3067],
        [-0.0289,  0.0165,  0.1163]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([], device='cuda:0', size=(0, 3), grad_fn=<SplitWithSizesBackward0>), tensor([[-0.0301, -0.1731,  0.1381],
        [ 0.1706, -0.1476,  0.1497],
        [-0.0756, -0.2760,  0.2184],
        [-0.1003, -0.2790,  0.2525]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.0450, -0.0690,  0.1502],
        [-0.0357, -0.1907,  0.1604],
        [-0.1891, -0.2608,  0.3457],
        [-0.0992, -0.2971,  0.1559],
        [-0.0163, -0.2098,  0.2148],
        [-0.0339, -0.3341,  0.1961]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.2152, -0.2532,  0.3399],
        [ 0.0883, -0.0774,  0.2437],
        [ 0.0438, -0.3038,  0.3318],
        [ 0.2261, -0.1152,  0.3867],
        [ 0.0118, -0.2400,  0.3065],
        [-0.0612, -0.1479,  0.2774],
        [ 0.1316, -0.2024,  0.3371],
        [ 0.1062, -0.2358,  0.3261],
        [ 0.0738, -0.1605,  0.2048],
        [ 0.0373, -0.2506,  0.3682],
        [ 0.1284, -0.1591,  0.3293],
        [-0.1195, -0.0986,  0.2262],
        [-0.1074, -0.1136,  0.2643],
        [ 0.0580,  0.0024,  0.3003],
        [ 0.0565, -0.1935,  0.2633],
        [ 0.1482, -0.2070,  0.1495],
        [ 0.0522, -0.2124,  0.1986],
        [-0.0393, -0.1318,  0.1560],
        [ 0.1121, -0.0414,  0.3328],
        [-0.0140, -0.0945,  0.2842],
        [ 0.1998, -0.1750,  0.1734],
        [-0.0299, -0.1254,  0.2616],
        [ 0.1024, -0.0991,  0.1805]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[ 0.0225, -0.0939,  0.2308],
        [-0.0107,  0.0228,  0.3110],
        [-0.0697, -0.2402,  0.1067],
        [-0.0016, -0.0750,  0.1905],
        [-0.0156, -0.0944,  0.1495],
        [ 0.0559,  0.0336,  0.1212],
        [-0.1769, -0.1051,  0.1465],
        [ 0.0579, -0.1739,  0.0908],
        [ 0.0009, -0.0145,  0.1136],
        [-0.0373, -0.0584,  0.2224],
        [-0.0197, -0.0642,  0.0095],
        [ 0.0078, -0.0737,  0.2441],
        [-0.0365, -0.0096,  0.0419],
        [ 0.0466, -0.1133,  0.2267],
        [-0.0603, -0.2138,  0.1123],
        [-0.0038, -0.0239,  0.1629],
        [-0.0931, -0.1111,  0.1667],
        [ 0.0112, -0.0576,  0.1286],
        [-0.0432, -0.0981,  0.2903],
        [ 0.0059, -0.1251,  0.2226],
        [ 0.0182, -0.1500,  0.2955],
        [-0.1648, -0.0258,  0.2421],
        [-0.0019, -0.0511,  0.1107]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.0481, -0.1384,  0.2409],
        [ 0.0897, -0.1171,  0.4227],
        [-0.0269, -0.2564,  0.2579]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.0883, -0.1168,  0.1716],
        [ 0.0024, -0.3137,  0.3239],
        [ 0.0095, -0.1541,  0.2859],
        [-0.1855, -0.1529,  0.1360],
        [-0.0324, -0.1985,  0.1454],
        [-0.1060, -0.1464,  0.1549],
        [-0.0550, -0.2957,  0.2498]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>))
pooled_logits tensor([[-0.0375, -0.1215,  0.1743],
        [    nan,     nan,     nan],
        [-0.0088, -0.2189,  0.1897],
        [-0.0699, -0.2269,  0.2039],
        [ 0.0430, -0.1581,  0.2714],
        [-0.0221, -0.0833,  0.1712],
        [ 0.0049, -0.1706,  0.3072],
        [-0.0651, -0.1969,  0.2096]], device='cuda:0', grad_fn=<CatBackward0>)

batch_loss nan
tensor([[  101,  9962,  4402,  ...,  5653,  1010,   102],
        [  101,  2030, 20905,  ...,  2006,  2602,   102],
        [  101,  2154,  2349,  ...,  2077,  1996,   102],
        ...,
        [  101,  2280,  2343,  ..., 11828,  2050,   102],
        [  101,  3049,  2000,  ...,  5905,  1997,   102],
        [  101,  1000,  1037,  ...,  2506,  1012,   102]], device='cuda:0')
tensor([2, 2, 2, 2, 2, 1, 2, 2], device='cuda:0')
logits tensor([[ 0.8308, -0.3855, -0.3887],
        [ 0.7892, -0.3592, -0.4777],
        [ 0.8840, -0.5626, -0.3776],
        [ 0.8702, -0.5947, -0.4464],
        [ 0.8383, -0.3957, -0.3438],
        [ 0.9228, -0.2835, -0.4466],
        [ 0.9435, -0.3383, -0.2801],
        [ 0.8078, -0.0984, -0.3712],
        [ 0.9303, -0.2332, -0.5102],
        [ 0.8681, -0.4160, -0.5805],
        [ 0.8823, -0.6342, -0.4230],
        [ 0.8700, -0.3017, -0.2907],
        [ 0.7904, -0.5354, -0.6434],
        [ 0.8849, -0.3987, -0.4664],
        [ 0.8924, -0.5492, -0.4525],
        [ 0.7835, -0.2926, -0.6301],
        [ 1.0565, -0.4470, -0.4647],
        [ 0.8295, -0.4062, -0.5379],
        [ 1.0320, -0.3717, -0.4282],
        [ 0.8115, -0.3433, -0.3599],
        [ 0.6715, -0.2513, -0.3657],
        [ 0.9948, -0.3660, -0.3457],
        [ 0.9311, -0.3127, -0.2690],
        [ 0.7978, -0.3791, -0.4260],
        [ 0.8582, -0.3383, -0.3867],
        [ 0.8676, -0.5244, -0.4200],
        [ 0.7189, -0.4058, -0.4331],
        [ 0.9096, -0.3211, -0.3514],
        [ 0.9731, -0.3501, -0.4324],
        [ 1.0585, -0.3370, -0.3629],
        [ 1.1096, -0.1950, -0.3291],
        [ 0.9628, -0.4398, -0.2384],
        [ 1.0180, -0.3387, -0.3822],
        [ 0.8593, -0.3741, -0.4315],
        [ 0.8721, -0.3532, -0.4074],
        [ 0.9886, -0.2540, -0.4493],
        [ 0.9126, -0.3350, -0.3672],
        [ 0.9590, -0.4702, -0.4353],
        [ 0.8654, -0.4615, -0.3061],
        [ 0.8920, -0.2503, -0.2648],
        [ 1.0112, -0.5532, -0.4562],
        [ 0.8694, -0.3538, -0.5716],
        [ 0.9294, -0.3788, -0.5925],
        [ 0.9330, -0.4938, -0.5145],
        [ 0.9488, -0.2743, -0.3599],
        [ 0.9858, -0.4546, -0.4105],
        [ 1.0078, -0.2517, -0.3620],
        [ 0.8299, -0.4416, -0.4253],
        [ 0.8224, -0.4702, -0.2578],
        [ 0.9819, -0.4272, -0.4951],
        [ 0.9662, -0.6678, -0.5848],
        [ 0.9207, -0.3363, -0.4784],
        [ 0.7999, -0.3384, -0.4506],
        [ 0.8493, -0.5223, -0.4705],
        [ 1.0252, -0.4430, -0.5505],
        [ 0.8875, -0.4043, -0.5690],
        [ 0.8526, -0.4017, -0.5968],
        [ 0.9119, -0.4920, -0.6058],
        [ 0.7952, -0.4758, -0.5605],
        [ 0.8681, -0.3587, -0.5877],
        [ 0.8248, -0.3471, -0.4929],
        [ 0.9857, -0.4928, -0.5593],
        [ 1.0402, -0.3735, -0.5793],
        [ 0.9726, -0.3641, -0.5239],
        [ 0.9277, -0.3487, -0.4366],
        [ 0.8870, -0.3670, -0.3793],
        [ 0.8470, -0.2745, -0.4962],
        [ 0.8987, -0.3517, -0.4689],
        [ 0.6669, -0.3543, -0.4705],
        [ 0.7661, -0.5915, -0.4961],
        [ 0.7860, -0.3283, -0.6307],
        [ 0.8821, -0.3848, -0.6393],
        [ 0.9063, -0.1433, -0.4382],
        [ 0.8704, -0.3730, -0.4523],
        [ 1.0144, -0.4327, -0.3891],
        [ 0.8918, -0.4412, -0.4457],
        [ 0.9922, -0.5004, -0.4635],
        [ 0.8648, -0.4156, -0.2780],
        [ 0.9331, -0.4770, -0.6322],
        [ 1.0070, -0.5356, -0.4292],
        [ 0.8173, -0.4084, -0.4720],
        [ 1.0516, -0.4712, -0.3817]], device='cuda:0',
       grad_fn=<AddmmBackward0>)
logits_split (tensor([[ 0.8308, -0.3855, -0.3887],
        [ 0.7892, -0.3592, -0.4777],
        [ 0.8840, -0.5626, -0.3776],
        [ 0.8702, -0.5947, -0.4464],
        [ 0.8383, -0.3957, -0.3438]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[ 0.9228, -0.2835, -0.4466],
        [ 0.9435, -0.3383, -0.2801],
        [ 0.8078, -0.0984, -0.3712],
        [ 0.9303, -0.2332, -0.5102]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[ 0.8681, -0.4160, -0.5805],
        [ 0.8823, -0.6342, -0.4230]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[ 0.8700, -0.3017, -0.2907],
        [ 0.7904, -0.5354, -0.6434],
        [ 0.8849, -0.3987, -0.4664],
        [ 0.8924, -0.5492, -0.4525],
        [ 0.7835, -0.2926, -0.6301]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[ 1.0565, -0.4470, -0.4647],
        [ 0.8295, -0.4062, -0.5379],
        [ 1.0320, -0.3717, -0.4282]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[ 0.8115, -0.3433, -0.3599],
        [ 0.6715, -0.2513, -0.3657],
        [ 0.9948, -0.3660, -0.3457],
        [ 0.9311, -0.3127, -0.2690],
        [ 0.7978, -0.3791, -0.4260],
        [ 0.8582, -0.3383, -0.3867],
        [ 0.8676, -0.5244, -0.4200],
        [ 0.7189, -0.4058, -0.4331],
        [ 0.9096, -0.3211, -0.3514],
        [ 0.9731, -0.3501, -0.4324],
        [ 1.0585, -0.3370, -0.3629],
        [ 1.1096, -0.1950, -0.3291],
        [ 0.9628, -0.4398, -0.2384],
        [ 1.0180, -0.3387, -0.3822],
        [ 0.8593, -0.3741, -0.4315],
        [ 0.8721, -0.3532, -0.4074],
        [ 0.9886, -0.2540, -0.4493],
        [ 0.9126, -0.3350, -0.3672],
        [ 0.9590, -0.4702, -0.4353],
        [ 0.8654, -0.4615, -0.3061],
        [ 0.8920, -0.2503, -0.2648]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[ 1.0112, -0.5532, -0.4562],
        [ 0.8694, -0.3538, -0.5716],
        [ 0.9294, -0.3788, -0.5925],
        [ 0.9330, -0.4938, -0.5145],
        [ 0.9488, -0.2743, -0.3599],
        [ 0.9858, -0.4546, -0.4105],
        [ 1.0078, -0.2517, -0.3620],
        [ 0.8299, -0.4416, -0.4253],
        [ 0.8224, -0.4702, -0.2578],
        [ 0.9819, -0.4272, -0.4951],
        [ 0.9662, -0.6678, -0.5848],
        [ 0.9207, -0.3363, -0.4784],
        [ 0.7999, -0.3384, -0.4506],
        [ 0.8493, -0.5223, -0.4705],
        [ 1.0252, -0.4430, -0.5505],
        [ 0.8875, -0.4043, -0.5690],
        [ 0.8526, -0.4017, -0.5968],
        [ 0.9119, -0.4920, -0.6058],
        [ 0.7952, -0.4758, -0.5605],
        [ 0.8681, -0.3587, -0.5877],
        [ 0.8248, -0.3471, -0.4929],
        [ 0.9857, -0.4928, -0.5593],
        [ 1.0402, -0.3735, -0.5793],
        [ 0.9726, -0.3641, -0.5239],
        [ 0.9277, -0.3487, -0.4366],
        [ 0.8870, -0.3670, -0.3793],
        [ 0.8470, -0.2745, -0.4962],
        [ 0.8987, -0.3517, -0.4689],
        [ 0.6669, -0.3543, -0.4705],
        [ 0.7661, -0.5915, -0.4961],
        [ 0.7860, -0.3283, -0.6307],
        [ 0.8821, -0.3848, -0.6393],
        [ 0.9063, -0.1433, -0.4382],
        [ 0.8704, -0.3730, -0.4523],
        [ 1.0144, -0.4327, -0.3891],
        [ 0.8918, -0.4412, -0.4457],
        [ 0.9922, -0.5004, -0.4635],
        [ 0.8648, -0.4156, -0.2780]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[ 0.9331, -0.4770, -0.6322],
        [ 1.0070, -0.5356, -0.4292],
        [ 0.8173, -0.4084, -0.4720],
        [ 1.0516, -0.4712, -0.3817]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>))
pooled_logits tensor([[ 0.8425, -0.4595, -0.4068],
        [ 0.9011, -0.2383, -0.4020],
        [ 0.8752, -0.5251, -0.5017],
        [ 0.8442, -0.4155, -0.4966],
        [ 0.9727, -0.4083, -0.4769],
        [ 0.9063, -0.3524, -0.3697],
        [ 0.9006, -0.4059, -0.4879],
        [ 0.9523, -0.4730, -0.4788]], device='cuda:0', grad_fn=<CatBackward0>)

batch_loss 1.7744674682617188
tensor([[  101,  1996,  4111,  ...,  3484,  1524,   102],
        [  101,  1997,  1996,  ..., 12481,  4378,   102],
        [  101,  6295,  1524,  ...,  1523,  5355,   102],
        ...,
        [  101, 16147,  2581,  ...,  2000,  5138,   102],
        [  101,  1996,  3408,  ...,  1012,  1996,   102],
        [  101,  2343,  2003,  ...,  2022, 13371,   102]], device='cuda:0')
tensor([2, 1, 2, 1, 2, 2, 1, 1], device='cuda:0')
logits tensor([[-0.5075, -0.3611,  1.2083],
        [-0.6656, -0.3064,  1.1141],
        [-0.5563, -0.4244,  1.1123],
        [-0.6324, -0.3337,  1.2335],
        [-0.4900, -0.3417,  1.1310],
        [-0.6561, -0.3332,  1.1289],
        [-0.5317, -0.4422,  1.2210],
        [-0.6500, -0.2907,  1.1059],
        [-0.5316, -0.1924,  0.8279],
        [-0.4090, -0.2645,  1.1181],
        [-0.5879, -0.4774,  1.2436],
        [-0.6447, -0.1968,  1.1290],
        [-0.5969, -0.3758,  1.3952],
        [-0.5958, -0.5240,  1.1282],
        [-0.5803, -0.2826,  1.0557],
        [-0.5886, -0.5053,  1.1239],
        [-0.6419, -0.4674,  0.9714],
        [-0.5795, -0.4211,  1.1090],
        [-0.8180, -0.3564,  0.9701],
        [-0.5382, -0.1568,  1.1733],
        [-0.6420, -0.1097,  1.0307],
        [-0.5369, -0.1425,  0.9554],
        [-0.5070, -0.4442,  0.9440],
        [-0.5599, -0.2621,  1.1042],
        [-0.6233, -0.2981,  1.0918],
        [-0.6748, -0.1476,  0.8619],
        [-0.4726, -0.5293,  1.2929],
        [-0.5195, -0.3602,  1.1511],
        [-0.5200, -0.4975,  1.1963],
        [-0.6314, -0.3149,  1.2551],
        [-0.5518, -0.2096,  1.0448],
        [-0.7038, -0.1909,  0.7184],
        [-0.4643, -0.1455,  0.7028],
        [-0.6633, -0.5325,  1.1400],
        [-0.7227, -0.3698,  0.8724],
        [-0.5660, -0.4698,  1.1203],
        [-0.6244, -0.4637,  1.1337],
        [-0.5733, -0.6539,  1.1954],
        [-0.8346, -0.3893,  1.1425],
        [-0.4310, -0.4837,  1.0358],
        [-0.6492, -0.2764,  1.2098],
        [-0.6063, -0.3403,  1.1199],
        [-0.8867, -0.2967,  0.9069],
        [-0.4936, -0.2822,  0.8424],
        [-0.5284, -0.3534,  1.1784],
        [-0.6799, -0.3565,  1.3091],
        [-0.5996, -0.4815,  1.1513],
        [-0.7069, -0.5624,  1.0504],
        [-0.5992, -0.4311,  1.2454],
        [-0.5866, -0.6498,  1.2613],
        [-0.5063, -0.3645,  0.9695],
        [-0.6389, -0.4995,  1.0131],
        [-0.5383, -0.5194,  1.1750],
        [-0.5575, -0.6878,  0.9677],
        [-0.5814, -0.2733,  0.9935],
        [-0.5682, -0.4782,  1.1296],
        [-0.6065, -0.3078,  1.1872],
        [-0.6936, -0.3148,  1.1652]], device='cuda:0',
       grad_fn=<AddmmBackward0>)
logits_split (tensor([[-0.5075, -0.3611,  1.2083],
        [-0.6656, -0.3064,  1.1141],
        [-0.5563, -0.4244,  1.1123],
        [-0.6324, -0.3337,  1.2335],
        [-0.4900, -0.3417,  1.1310],
        [-0.6561, -0.3332,  1.1289],
        [-0.5317, -0.4422,  1.2210],
        [-0.6500, -0.2907,  1.1059],
        [-0.5316, -0.1924,  0.8279],
        [-0.4090, -0.2645,  1.1181],
        [-0.5879, -0.4774,  1.2436],
        [-0.6447, -0.1968,  1.1290]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.5969, -0.3758,  1.3952],
        [-0.5958, -0.5240,  1.1282],
        [-0.5803, -0.2826,  1.0557],
        [-0.5886, -0.5053,  1.1239],
        [-0.6419, -0.4674,  0.9714],
        [-0.5795, -0.4211,  1.1090],
        [-0.8180, -0.3564,  0.9701]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.5382, -0.1568,  1.1733],
        [-0.6420, -0.1097,  1.0307],
        [-0.5369, -0.1425,  0.9554],
        [-0.5070, -0.4442,  0.9440],
        [-0.5599, -0.2621,  1.1042],
        [-0.6233, -0.2981,  1.0918],
        [-0.6748, -0.1476,  0.8619]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.4726, -0.5293,  1.2929],
        [-0.5195, -0.3602,  1.1511],
        [-0.5200, -0.4975,  1.1963],
        [-0.6314, -0.3149,  1.2551],
        [-0.5518, -0.2096,  1.0448],
        [-0.7038, -0.1909,  0.7184]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.4643, -0.1455,  0.7028],
        [-0.6633, -0.5325,  1.1400],
        [-0.7227, -0.3698,  0.8724]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.5660, -0.4698,  1.1203],
        [-0.6244, -0.4637,  1.1337],
        [-0.5733, -0.6539,  1.1954],
        [-0.8346, -0.3893,  1.1425],
        [-0.4310, -0.4837,  1.0358]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.6492, -0.2764,  1.2098],
        [-0.6063, -0.3403,  1.1199],
        [-0.8867, -0.2967,  0.9069],
        [-0.4936, -0.2822,  0.8424],
        [-0.5284, -0.3534,  1.1784],
        [-0.6799, -0.3565,  1.3091]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.5996, -0.4815,  1.1513],
        [-0.7069, -0.5624,  1.0504],
        [-0.5992, -0.4311,  1.2454],
        [-0.5866, -0.6498,  1.2613],
        [-0.5063, -0.3645,  0.9695],
        [-0.6389, -0.4995,  1.0131],
        [-0.5383, -0.5194,  1.1750],
        [-0.5575, -0.6878,  0.9677],
        [-0.5814, -0.2733,  0.9935],
        [-0.5682, -0.4782,  1.1296],
        [-0.6065, -0.3078,  1.1872],
        [-0.6936, -0.3148,  1.1652]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>))
pooled_logits tensor([[-0.5719, -0.3304,  1.1311],
        [-0.6287, -0.4190,  1.1076],
        [-0.5832, -0.2230,  1.0231],
        [-0.5665, -0.3504,  1.1098],
        [-0.6168, -0.3493,  0.9051],
        [-0.6059, -0.4921,  1.1255],
        [-0.6407, -0.3176,  1.0944],
        [-0.5986, -0.4642,  1.1091]], device='cuda:0', grad_fn=<CatBackward0>)

batch_loss 1.122658610343933
tensor([[  101,  4407,  2038,  ...,  2029,  1996,   102],
        [  101,  4372, 26468,  ...,  1010,  2023,   102],
        [  101,  9311,  2103,  ...,  2489,  6067,   102],
        ...,
        [  101,  5876,  1012,  ...,  2041,  2005,   102],
        [  101,  2010,  2388,  ..., 17298, 13900,   102],
        [  101,  2121,  2097,  ...,  6187,  7100,   102]], device='cuda:0')
tensor([1, 2, 1, 1, 2, 2, 1, 2], device='cuda:0')
logits tensor([[-0.7342,  0.3573,  0.5131],
        [-0.9794,  0.4073,  0.7291],
        [-0.8662,  0.5323,  0.4651],
        [-1.0629,  0.4360,  0.6106],
        [-0.9272,  0.2444,  0.8392],
        [-0.9762,  0.3789,  0.5282],
        [-1.0574,  0.5284,  0.4177],
        [-0.9967,  0.5503,  0.4632],
        [-0.8936,  0.5807,  0.5701],
        [-0.8343,  0.5117,  0.4829],
        [-0.8435,  0.4702,  0.5636],
        [-0.8674,  0.6730,  0.6137],
        [-0.9176,  0.5983,  0.3309],
        [-0.8182,  0.5535,  0.5482],
        [-0.9000,  0.4544,  0.5964],
        [-0.8716,  0.5523,  0.3982],
        [-0.7863,  0.3730,  0.6579],
        [-0.8527,  0.5148,  0.7594],
        [-1.0013,  0.5566,  0.5009],
        [-0.7654,  0.5102,  0.5363],
        [-1.0728,  0.5069,  0.5805],
        [-0.7671,  0.3788,  0.4996],
        [-0.9719,  0.3099,  0.5435],
        [-0.9399,  0.4058,  0.8014],
        [-0.8689,  0.2870,  0.6025],
        [-1.0156,  0.5957,  0.5406],
        [-0.9378,  0.5399,  0.7661],
        [-0.9044,  0.4257,  0.6714],
        [-0.9029,  0.4779,  0.5825],
        [-0.9950,  0.4302,  0.6823],
        [-0.8645,  0.5593,  0.7453],
        [-0.8858,  0.3339,  0.8572],
        [-0.9816,  0.5513,  0.7552],
        [-0.8503,  0.4175,  0.6272],
        [-0.9000,  0.3950,  0.5275],
        [-0.9892,  0.4935,  0.3868],
        [-0.8481,  0.3563,  0.8087],
        [-1.1839,  0.4844,  0.7086],
        [-1.0351,  0.3097,  0.6514],
        [-0.9485,  0.3464,  0.6923],
        [-1.0809,  0.3247,  0.6400],
        [-0.9214,  0.3766,  0.7662],
        [-1.0487,  0.4933,  0.5121],
        [-0.8630,  0.4853,  0.5991],
        [-1.0559,  0.3771,  0.5148],
        [-0.9830,  0.4064,  0.6661],
        [-0.8666,  0.4745,  0.5397],
        [-0.9406,  0.4114,  0.3688],
        [-0.8260,  0.4731,  0.5082],
        [-1.1175,  0.7545,  0.4366],
        [-0.9331,  0.5009,  0.5043],
        [-0.8426,  0.5280,  0.5042],
        [-1.0113,  0.5343,  0.4701],
        [-1.0339,  0.4743,  0.6574],
        [-1.0060,  0.4383,  0.6064],
        [-0.8544,  0.3999,  0.7276],
        [-0.9105,  0.4614,  0.5784],
        [-1.0477,  0.3665,  0.4095],
        [-1.0048,  0.5074,  0.5609],
        [-0.9849,  0.4906,  0.5570],
        [-0.9405,  0.4627,  0.5006],
        [-1.0064,  0.3871,  0.7301],
        [-0.9365,  0.4668,  0.6972],
        [-1.0444,  0.5060,  0.8684],
        [-0.9324,  0.5271,  0.6192],
        [-0.9184,  0.5738,  0.6343],
        [-1.0438,  0.4739,  0.7547],
        [-1.0139,  0.5045,  0.6372],
        [-0.9828,  0.5666,  0.5780],
        [-0.9496,  0.5340,  0.4706],
        [-0.8812,  0.6982,  0.4626],
        [-0.8821,  0.5446,  0.6467],
        [-1.0292,  0.5672,  0.6082],
        [-1.0619,  0.4668,  0.7437],
        [-1.0142,  0.4700,  0.7369],
        [-1.1107,  0.3753,  0.3317],
        [-1.1424,  0.5375,  0.5572],
        [-0.9511,  0.4795,  0.5531],
        [-0.9401,  0.5621,  0.4698],
        [-0.9347,  0.5199,  0.3845],
        [-0.7910,  0.4916,  0.4787],
        [-0.8924,  0.4486,  0.5062],
        [-1.0112,  0.3546,  0.5913],
        [-1.0201,  0.4891,  0.5416],
        [-0.9923,  0.5892,  0.7082],
        [-1.0179,  0.4804,  0.5422],
        [-0.8120,  0.4944,  0.7420],
        [-1.0083,  0.3831,  0.5819],
        [-0.9658,  0.5557,  0.7377],
        [-0.8930,  0.6187,  0.6410],
        [-0.8355,  0.5455,  0.6716],
        [-1.0181,  0.5080,  0.7229],
        [-0.8145,  0.5635,  0.5583],
        [-0.8956,  0.4495,  0.5817],
        [-1.0011,  0.4504,  0.6672],
        [-0.9216,  0.4173,  0.4957],
        [-1.0028,  0.2951,  0.3862],
        [-0.8760,  0.3865,  0.6797],
        [-0.8333,  0.5482,  0.6945],
        [-0.8631,  0.4686,  0.7131],
        [-0.7581,  0.2945,  0.6740],
        [-0.8675,  0.1241,  0.6688],
        [-0.8639,  0.2076,  0.7159],
        [-0.8454,  0.3683,  0.6300],
        [-0.9104,  0.2104,  0.5687],
        [-1.0394,  0.1700,  0.5024],
        [-0.8798,  0.4183,  0.5517],
        [-1.1624,  0.2173,  0.6722]], device='cuda:0',
       grad_fn=<AddmmBackward0>)
logits_split (tensor([[-0.7342,  0.3573,  0.5131],
        [-0.9794,  0.4073,  0.7291],
        [-0.8662,  0.5323,  0.4651],
        [-1.0629,  0.4360,  0.6106],
        [-0.9272,  0.2444,  0.8392],
        [-0.9762,  0.3789,  0.5282],
        [-1.0574,  0.5284,  0.4177],
        [-0.9967,  0.5503,  0.4632],
        [-0.8936,  0.5807,  0.5701],
        [-0.8343,  0.5117,  0.4829],
        [-0.8435,  0.4702,  0.5636],
        [-0.8674,  0.6730,  0.6137],
        [-0.9176,  0.5983,  0.3309],
        [-0.8182,  0.5535,  0.5482],
        [-0.9000,  0.4544,  0.5964],
        [-0.8716,  0.5523,  0.3982],
        [-0.7863,  0.3730,  0.6579],
        [-0.8527,  0.5148,  0.7594],
        [-1.0013,  0.5566,  0.5009],
        [-0.7654,  0.5102,  0.5363],
        [-1.0728,  0.5069,  0.5805],
        [-0.7671,  0.3788,  0.4996],
        [-0.9719,  0.3099,  0.5435],
        [-0.9399,  0.4058,  0.8014],
        [-0.8689,  0.2870,  0.6025],
        [-1.0156,  0.5957,  0.5406],
        [-0.9378,  0.5399,  0.7661]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.9044,  0.4257,  0.6714],
        [-0.9029,  0.4779,  0.5825],
        [-0.9950,  0.4302,  0.6823],
        [-0.8645,  0.5593,  0.7453],
        [-0.8858,  0.3339,  0.8572],
        [-0.9816,  0.5513,  0.7552],
        [-0.8503,  0.4175,  0.6272]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.9000,  0.3950,  0.5275],
        [-0.9892,  0.4935,  0.3868],
        [-0.8481,  0.3563,  0.8087],
        [-1.1839,  0.4844,  0.7086],
        [-1.0351,  0.3097,  0.6514]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.9485,  0.3464,  0.6923],
        [-1.0809,  0.3247,  0.6400],
        [-0.9214,  0.3766,  0.7662],
        [-1.0487,  0.4933,  0.5121],
        [-0.8630,  0.4853,  0.5991],
        [-1.0559,  0.3771,  0.5148],
        [-0.9830,  0.4064,  0.6661],
        [-0.8666,  0.4745,  0.5397],
        [-0.9406,  0.4114,  0.3688],
        [-0.8260,  0.4731,  0.5082],
        [-1.1175,  0.7545,  0.4366],
        [-0.9331,  0.5009,  0.5043],
        [-0.8426,  0.5280,  0.5042],
        [-1.0113,  0.5343,  0.4701],
        [-1.0339,  0.4743,  0.6574],
        [-1.0060,  0.4383,  0.6064],
        [-0.8544,  0.3999,  0.7276],
        [-0.9105,  0.4614,  0.5784],
        [-1.0477,  0.3665,  0.4095],
        [-1.0048,  0.5074,  0.5609],
        [-0.9849,  0.4906,  0.5570],
        [-0.9405,  0.4627,  0.5006],
        [-1.0064,  0.3871,  0.7301],
        [-0.9365,  0.4668,  0.6972],
        [-1.0444,  0.5060,  0.8684],
        [-0.9324,  0.5271,  0.6192],
        [-0.9184,  0.5738,  0.6343],
        [-1.0438,  0.4739,  0.7547],
        [-1.0139,  0.5045,  0.6372],
        [-0.9828,  0.5666,  0.5780],
        [-0.9496,  0.5340,  0.4706],
        [-0.8812,  0.6982,  0.4626],
        [-0.8821,  0.5446,  0.6467],
        [-1.0292,  0.5672,  0.6082],
        [-1.0619,  0.4668,  0.7437],
        [-1.0142,  0.4700,  0.7369],
        [-1.1107,  0.3753,  0.3317],
        [-1.1424,  0.5375,  0.5572],
        [-0.9511,  0.4795,  0.5531],
        [-0.9401,  0.5621,  0.4698],
        [-0.9347,  0.5199,  0.3845],
        [-0.7910,  0.4916,  0.4787],
        [-0.8924,  0.4486,  0.5062],
        [-1.0112,  0.3546,  0.5913],
        [-1.0201,  0.4891,  0.5416],
        [-0.9923,  0.5892,  0.7082],
        [-1.0179,  0.4804,  0.5422],
        [-0.8120,  0.4944,  0.7420]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-1.0083,  0.3831,  0.5819],
        [-0.9658,  0.5557,  0.7377],
        [-0.8930,  0.6187,  0.6410]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.8355,  0.5455,  0.6716],
        [-1.0181,  0.5080,  0.7229],
        [-0.8145,  0.5635,  0.5583],
        [-0.8956,  0.4495,  0.5817],
        [-1.0011,  0.4504,  0.6672]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.9216,  0.4173,  0.4957],
        [-1.0028,  0.2951,  0.3862],
        [-0.8760,  0.3865,  0.6797],
        [-0.8333,  0.5482,  0.6945]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.8631,  0.4686,  0.7131],
        [-0.7581,  0.2945,  0.6740],
        [-0.8675,  0.1241,  0.6688],
        [-0.8639,  0.2076,  0.7159],
        [-0.8454,  0.3683,  0.6300],
        [-0.9104,  0.2104,  0.5687],
        [-1.0394,  0.1700,  0.5024],
        [-0.8798,  0.4183,  0.5517],
        [-1.1624,  0.2173,  0.6722]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>))
pooled_logits tensor([[-0.9084,  0.4744,  0.5726],
        [-0.9121,  0.4565,  0.7030],
        [-0.9913,  0.4078,  0.6166],
        [-0.9695,  0.4833,  0.5816],
        [-0.9557,  0.5192,  0.6536],
        [-0.9130,  0.5034,  0.6403],
        [-0.9084,  0.4118,  0.5640],
        [-0.9100,  0.2755,  0.6330]], device='cuda:0', grad_fn=<CatBackward0>)

batch_loss 0.7898355722427368
tensor([[  101,  7112,  5061,  ...,  1012,  2009,   102],
        [  101,  4972,  2066,  ...,  4668,  2124,   102],
        [  101,  2004,  6778,  ...,  4667,  2010,   102],
        ...,
        [  101,  2807,  1010,  ...,  4352,  2033,   102],
        [  101,  2000,  2156,  ..., 12857,  1010,   102],
        [  101,  1524, 23401,  ...,  2979,  1999,   102]], device='cuda:0')
tensor([1, 1, 0, 1], device='cuda:0')
logits tensor([[-1.1713,  0.8095,  0.6136],
        [-0.9904,  0.6204,  0.4820],
        [-1.0890,  0.5947,  0.7392],
        [-1.1532,  0.5965,  0.6095],
        [-1.3405,  0.6227,  0.6947],
        [-1.4490,  0.5837,  0.7512],
        [-1.2525,  0.5720,  0.6882],
        [-1.1580,  0.8991,  0.7000],
        [-1.0285,  0.6550,  0.6554],
        [-1.2500,  0.5544,  0.5177],
        [-1.2338,  0.7718,  0.5683],
        [-1.1717,  0.6411,  0.8128],
        [-1.2274,  0.7060,  0.5916],
        [-1.3180,  0.6118,  0.4392],
        [-1.1521,  0.6606,  0.7507],
        [-1.2105,  0.6840,  0.7313],
        [-1.0662,  0.6514,  0.5960],
        [-1.1585,  0.7727,  0.6946],
        [-1.3226,  0.7034,  0.5921],
        [-0.9516,  0.7621,  0.3721],
        [-1.0357,  0.7632,  0.4033],
        [-1.1101,  0.7075,  0.5597],
        [-1.0788,  0.6586,  0.6468],
        [-1.1013,  0.8579,  0.4860],
        [-1.2054,  0.6850,  0.6734],
        [-1.1645,  0.7943,  0.6065],
        [-1.1770,  0.8896,  0.7840],
        [-1.0818,  0.7258,  0.6178],
        [-1.1475,  0.5719,  0.5769],
        [-1.2003,  0.8573,  0.6924],
        [-1.0281,  0.6964,  0.5442],
        [-1.0184,  0.9115,  0.6474],
        [-1.0039,  0.8761,  0.4822],
        [-1.1728,  0.7579,  0.5405],
        [-1.2129,  0.7429,  0.5448],
        [-1.1296,  0.9903,  0.4836],
        [-1.2173,  0.6757,  0.4631],
        [-1.1647,  0.7409,  0.5436],
        [-1.3268,  0.6043,  0.4368],
        [-1.2057,  0.7231,  0.6100],
        [-1.1852,  0.6372,  0.5606],
        [-1.2179,  0.5002,  0.5672],
        [-1.3913,  0.6805,  0.5070],
        [-1.1999,  0.5880,  0.5103],
        [-1.1397,  0.5976,  0.4196],
        [-1.3494,  0.6376,  0.6583],
        [-1.1768,  0.6824,  0.7498],
        [-0.9006,  0.6826,  0.4278],
        [-1.0763,  0.5718,  0.7555],
        [-1.1581,  0.5213,  0.7174],
        [-1.0841,  0.5636,  0.6892],
        [-1.1515,  0.6134,  0.6763]], device='cuda:0',
       grad_fn=<AddmmBackward0>)
logits_split (tensor([[-1.1713,  0.8095,  0.6136],
        [-0.9904,  0.6204,  0.4820],
        [-1.0890,  0.5947,  0.7392],
        [-1.1532,  0.5965,  0.6095],
        [-1.3405,  0.6227,  0.6947],
        [-1.4490,  0.5837,  0.7512],
        [-1.2525,  0.5720,  0.6882],
        [-1.1580,  0.8991,  0.7000],
        [-1.0285,  0.6550,  0.6554],
        [-1.2500,  0.5544,  0.5177],
        [-1.2338,  0.7718,  0.5683],
        [-1.1717,  0.6411,  0.8128],
        [-1.2274,  0.7060,  0.5916],
        [-1.3180,  0.6118,  0.4392],
        [-1.1521,  0.6606,  0.7507]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-1.2105,  0.6840,  0.7313],
        [-1.0662,  0.6514,  0.5960],
        [-1.1585,  0.7727,  0.6946],
        [-1.3226,  0.7034,  0.5921],
        [-0.9516,  0.7621,  0.3721],
        [-1.0357,  0.7632,  0.4033],
        [-1.1101,  0.7075,  0.5597],
        [-1.0788,  0.6586,  0.6468],
        [-1.1013,  0.8579,  0.4860],
        [-1.2054,  0.6850,  0.6734],
        [-1.1645,  0.7943,  0.6065],
        [-1.1770,  0.8896,  0.7840],
        [-1.0818,  0.7258,  0.6178],
        [-1.1475,  0.5719,  0.5769],
        [-1.2003,  0.8573,  0.6924],
        [-1.0281,  0.6964,  0.5442],
        [-1.0184,  0.9115,  0.6474],
        [-1.0039,  0.8761,  0.4822],
        [-1.1728,  0.7579,  0.5405],
        [-1.2129,  0.7429,  0.5448],
        [-1.1296,  0.9903,  0.4836],
        [-1.2173,  0.6757,  0.4631],
        [-1.1647,  0.7409,  0.5436],
        [-1.3268,  0.6043,  0.4368]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-1.2057,  0.7231,  0.6100],
        [-1.1852,  0.6372,  0.5606],
        [-1.2179,  0.5002,  0.5672],
        [-1.3913,  0.6805,  0.5070],
        [-1.1999,  0.5880,  0.5103],
        [-1.1397,  0.5976,  0.4196],
        [-1.3494,  0.6376,  0.6583],
        [-1.1768,  0.6824,  0.7498]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.9006,  0.6826,  0.4278],
        [-1.0763,  0.5718,  0.7555],
        [-1.1581,  0.5213,  0.7174],
        [-1.0841,  0.5636,  0.6892],
        [-1.1515,  0.6134,  0.6763]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>))
pooled_logits tensor([[-1.1990,  0.6599,  0.6409],
        [-1.1369,  0.7534,  0.5716],
        [-1.2332,  0.6308,  0.5729],
        [-1.0741,  0.5905,  0.6532]], device='cuda:0', grad_fn=<CatBackward0>)

batch_loss 1.9383604526519775
total_loss nan
Training loss: nan
Validation loss: nan

------------------------- Epoch 2 -------------------------
tensor([[  101,  3513, 23802,  ...,  2092,  1011,   102],
        [  101, 10959,  2000,  ...,  7300, 13965,   102],
        [  101,  1011, 13115,  ..., 19153,  1998,   102],
        ...,
        [  101,  1012,  2009,  ...,  2138,  2057,   102],
        [  101,  2024,  2092,  ..., 17258,  9259,   102],
        [  101,  3303,  3571,  ..., 16939,  1010,   102]], device='cuda:0')
tensor([2, 1, 0, 1, 2, 1, 0, 1], device='cuda:0')
logits tensor([[-0.0899,  0.5526, -0.3546],
        [-0.0432,  0.5711, -0.3207],
        [-0.1437,  0.4764, -0.4082],
        [-0.1210,  0.2548, -0.3753],
        [-0.1568,  0.5961, -0.5912],
        [-0.0851,  0.3609, -0.3919],
        [-0.0869,  0.6004, -0.4113],
        [-0.0317,  0.5625, -0.2372],
        [-0.2606,  0.4647, -0.4739],
        [-0.0897,  0.4526, -0.3864],
        [-0.0705,  0.4291, -0.2662],
        [-0.0960,  0.4232, -0.2340],
        [-0.2406,  0.5104, -0.3071],
        [-0.0700,  0.5092, -0.4869],
        [-0.0905,  0.5091, -0.3822],
        [-0.1835,  0.4563, -0.2874],
        [-0.2437,  0.4427, -0.3626],
        [-0.1101,  0.4964, -0.4609],
        [-0.1636,  0.4215, -0.4522],
        [-0.1505,  0.5010, -0.3625],
        [ 0.0121,  0.5861, -0.4074],
        [-0.0388,  0.6300, -0.3712],
        [-0.0571,  0.2915, -0.3130],
        [-0.0351,  0.3556, -0.3401],
        [-0.0059,  0.2499, -0.2921],
        [ 0.0624,  0.2154, -0.3866],
        [-0.1868,  0.4033, -0.2445],
        [-0.0147,  0.2584, -0.1721],
        [ 0.0393,  0.3300, -0.2652],
        [-0.0893,  0.2772, -0.3810],
        [-0.0603,  0.3349, -0.3393],
        [-0.0289,  0.3742, -0.3238],
        [-0.1699,  0.3844, -0.2443],
        [-0.0940,  0.5026, -0.4070],
        [-0.0259,  0.3379, -0.1693],
        [-0.0361,  0.3905, -0.2141],
        [ 0.0024,  0.4167, -0.1061],
        [-0.0289,  0.5097, -0.1132],
        [ 0.0258,  0.4490, -0.2794],
        [ 0.0200,  0.4570, -0.2220],
        [-0.1522,  0.4051, -0.2199],
        [-0.0272,  0.5603,  0.0429],
        [-0.0651,  0.5954, -0.3404],
        [-0.1365,  0.5896, -0.2747],
        [-0.0993,  0.5487, -0.2805],
        [ 0.1672,  0.5288, -0.4809],
        [ 0.0983,  0.5364, -0.2341],
        [ 0.0643,  0.4778, -0.3200],
        [-0.0021,  0.3951, -0.2487],
        [-0.0359,  0.4835, -0.4533],
        [ 0.0570,  0.5058, -0.1038],
        [-0.0521,  0.5361, -0.3155],
        [-0.1780,  0.4814, -0.1457],
        [-0.0611,  0.4816, -0.2821],
        [-0.1572,  0.4492, -0.4373],
        [ 0.0259,  0.5385, -0.3184],
        [ 0.0140,  0.6426, -0.3003],
        [-0.0728,  0.4199, -0.3541],
        [-0.1145,  0.5790, -0.3190],
        [-0.3125,  0.5475, -0.5257],
        [-0.0655,  0.4515, -0.5606],
        [-0.1076,  0.5689, -0.3904],
        [-0.1858,  0.4928, -0.5345],
        [-0.1297,  0.4954, -0.3889],
        [-0.2419,  0.4909, -0.4452],
        [-0.1048,  0.5077, -0.4401],
        [-0.1651,  0.4641, -0.5021],
        [-0.1324,  0.3682, -0.4186],
        [-0.0867,  0.4819, -0.4750],
        [-0.1803,  0.4803, -0.3614],
        [-0.1714,  0.4575, -0.5266],
        [-0.2641,  0.4388, -0.4401],
        [-0.1115,  0.5279, -0.3974],
        [-0.1255,  0.4683, -0.4428],
        [-0.0759,  0.3761, -0.5888],
        [-0.2318,  0.4658, -0.3872],
        [-0.0886,  0.3771, -0.4274],
        [-0.2289,  0.5447, -0.5000],
        [ 0.1029,  0.3748, -0.4017],
        [ 0.2949,  0.4127, -0.2466],
        [ 0.1943,  0.3000, -0.2680],
        [-0.0686,  0.4936, -0.4161],
        [-0.0663,  0.4674, -0.3913],
        [ 0.1006,  0.3535, -0.2279],
        [-0.1371,  0.3728, -0.5047],
        [ 0.0040,  0.3612, -0.3936],
        [-0.0507,  0.3983, -0.4267],
        [-0.0304,  0.3378, -0.3745]], device='cuda:0',
       grad_fn=<AddmmBackward0>)
logits_split (tensor([[-0.0899,  0.5526, -0.3546],
        [-0.0432,  0.5711, -0.3207],
        [-0.1437,  0.4764, -0.4082],
        [-0.1210,  0.2548, -0.3753],
        [-0.1568,  0.5961, -0.5912],
        [-0.0851,  0.3609, -0.3919],
        [-0.0869,  0.6004, -0.4113],
        [-0.0317,  0.5625, -0.2372],
        [-0.2606,  0.4647, -0.4739],
        [-0.0897,  0.4526, -0.3864],
        [-0.0705,  0.4291, -0.2662],
        [-0.0960,  0.4232, -0.2340],
        [-0.2406,  0.5104, -0.3071],
        [-0.0700,  0.5092, -0.4869],
        [-0.0905,  0.5091, -0.3822],
        [-0.1835,  0.4563, -0.2874],
        [-0.2437,  0.4427, -0.3626],
        [-0.1101,  0.4964, -0.4609],
        [-0.1636,  0.4215, -0.4522],
        [-0.1505,  0.5010, -0.3625],
        [ 0.0121,  0.5861, -0.4074],
        [-0.0388,  0.6300, -0.3712]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([], device='cuda:0', size=(0, 3), grad_fn=<SplitWithSizesBackward0>), tensor([[-0.0571,  0.2915, -0.3130],
        [-0.0351,  0.3556, -0.3401],
        [-0.0059,  0.2499, -0.2921],
        [ 0.0624,  0.2154, -0.3866]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.1868,  0.4033, -0.2445],
        [-0.0147,  0.2584, -0.1721],
        [ 0.0393,  0.3300, -0.2652],
        [-0.0893,  0.2772, -0.3810],
        [-0.0603,  0.3349, -0.3393],
        [-0.0289,  0.3742, -0.3238]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.1699,  0.3844, -0.2443],
        [-0.0940,  0.5026, -0.4070],
        [-0.0259,  0.3379, -0.1693],
        [-0.0361,  0.3905, -0.2141],
        [ 0.0024,  0.4167, -0.1061],
        [-0.0289,  0.5097, -0.1132],
        [ 0.0258,  0.4490, -0.2794],
        [ 0.0200,  0.4570, -0.2220],
        [-0.1522,  0.4051, -0.2199],
        [-0.0272,  0.5603,  0.0429],
        [-0.0651,  0.5954, -0.3404],
        [-0.1365,  0.5896, -0.2747],
        [-0.0993,  0.5487, -0.2805],
        [ 0.1672,  0.5288, -0.4809],
        [ 0.0983,  0.5364, -0.2341],
        [ 0.0643,  0.4778, -0.3200],
        [-0.0021,  0.3951, -0.2487],
        [-0.0359,  0.4835, -0.4533],
        [ 0.0570,  0.5058, -0.1038],
        [-0.0521,  0.5361, -0.3155],
        [-0.1780,  0.4814, -0.1457],
        [-0.0611,  0.4816, -0.2821],
        [-0.1572,  0.4492, -0.4373]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[ 0.0259,  0.5385, -0.3184],
        [ 0.0140,  0.6426, -0.3003],
        [-0.0728,  0.4199, -0.3541],
        [-0.1145,  0.5790, -0.3190],
        [-0.3125,  0.5475, -0.5257],
        [-0.0655,  0.4515, -0.5606],
        [-0.1076,  0.5689, -0.3904],
        [-0.1858,  0.4928, -0.5345],
        [-0.1297,  0.4954, -0.3889],
        [-0.2419,  0.4909, -0.4452],
        [-0.1048,  0.5077, -0.4401],
        [-0.1651,  0.4641, -0.5021],
        [-0.1324,  0.3682, -0.4186],
        [-0.0867,  0.4819, -0.4750],
        [-0.1803,  0.4803, -0.3614],
        [-0.1714,  0.4575, -0.5266],
        [-0.2641,  0.4388, -0.4401],
        [-0.1115,  0.5279, -0.3974],
        [-0.1255,  0.4683, -0.4428],
        [-0.0759,  0.3761, -0.5888],
        [-0.2318,  0.4658, -0.3872],
        [-0.0886,  0.3771, -0.4274],
        [-0.2289,  0.5447, -0.5000]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[ 0.1029,  0.3748, -0.4017],
        [ 0.2949,  0.4127, -0.2466],
        [ 0.1943,  0.3000, -0.2680]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.0686,  0.4936, -0.4161],
        [-0.0663,  0.4674, -0.3913],
        [ 0.1006,  0.3535, -0.2279],
        [-0.1371,  0.3728, -0.5047],
        [ 0.0040,  0.3612, -0.3936],
        [-0.0507,  0.3983, -0.4267],
        [-0.0304,  0.3378, -0.3745]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>))
pooled_logits tensor([[-0.1161,  0.4912, -0.3787],
        [    nan,     nan,     nan],
        [-0.0089,  0.2781, -0.3329],
        [-0.0568,  0.3297, -0.2876],
        [-0.0386,  0.4792, -0.2543],
        [-0.1373,  0.4863, -0.4367],
        [ 0.1974,  0.3625, -0.3054],
        [-0.0355,  0.3978, -0.3907]], device='cuda:0', grad_fn=<CatBackward0>)

batch_loss nan
tensor([[  101,  9962,  4402,  ...,  5653,  1010,   102],
        [  101,  2030, 20905,  ...,  2006,  2602,   102],
        [  101,  2154,  2349,  ...,  2077,  1996,   102],
        ...,
        [  101,  2280,  2343,  ..., 11828,  2050,   102],
        [  101,  3049,  2000,  ...,  5905,  1997,   102],
        [  101,  1000,  1037,  ...,  2506,  1012,   102]], device='cuda:0')
tensor([2, 2, 2, 2, 2, 1, 2, 2], device='cuda:0')
logits tensor([[ 0.2767, -0.0276, -0.3775],
        [ 0.4982, -0.1634, -0.3024],
        [ 0.4199, -0.1065, -0.2961],
        [ 0.4240, -0.2292, -0.4011],
        [ 0.4347,  0.0893, -0.3319],
        [ 0.5307,  0.0272, -0.5052],
        [ 0.5598, -0.0311, -0.4045],
        [ 0.4016,  0.1425, -0.4174],
        [ 0.4112,  0.1113, -0.3253],
        [ 0.4547, -0.0381, -0.5977],
        [ 0.3406, -0.0881, -0.4271],
        [ 0.5988,  0.0357, -0.3656],
        [ 0.4192, -0.1255, -0.5113],
        [ 0.4377,  0.0505, -0.3538],
        [ 0.5238, -0.1894, -0.2511],
        [ 0.4252,  0.2393, -0.4532],
        [ 0.7047,  0.0220, -0.2466],
        [ 0.6108, -0.1599, -0.3859],
        [ 0.6109, -0.0045, -0.2741],
        [ 0.4751, -0.1734, -0.5666],
        [ 0.4700,  0.0253, -0.3861],
        [ 0.5213, -0.0234, -0.3050],
        [ 0.5400, -0.1319, -0.2371],
        [ 0.3432,  0.0058, -0.6281],
        [ 0.3658, -0.0835, -0.6357],
        [ 0.4206, -0.0313, -0.5518],
        [ 0.4284,  0.0971, -0.4089],
        [ 0.5395,  0.0224, -0.3149],
        [ 0.4548, -0.0440, -0.3283],
        [ 0.5412, -0.0283, -0.6132],
        [ 0.6781,  0.0277, -0.2163],
        [ 0.6869, -0.0999, -0.4217],
        [ 0.4639, -0.0120, -0.2977],
        [ 0.4571, -0.1266, -0.2566],
        [ 0.5883, -0.0385, -0.2506],
        [ 0.5114,  0.1235, -0.3052],
        [ 0.5968, -0.0280, -0.3885],
        [ 0.4460, -0.1532, -0.4096],
        [ 0.4619, -0.0857, -0.5351],
        [ 0.6678, -0.1698, -0.4836],
        [ 0.4978, -0.0508, -0.3300],
        [ 0.4817, -0.0994, -0.3177],
        [ 0.4732,  0.0374, -0.5011],
        [ 0.3941,  0.0424, -0.2303],
        [ 0.5044,  0.2759, -0.2278],
        [ 0.5250, -0.0383, -0.2163],
        [ 0.4625,  0.1460, -0.5105],
        [ 0.4351,  0.1178, -0.3369],
        [ 0.4260,  0.0478, -0.2169],
        [ 0.3456, -0.0678, -0.2221],
        [ 0.4959, -0.0856, -0.4403],
        [ 0.5498,  0.0525, -0.2063],
        [ 0.4078,  0.1090, -0.2667],
        [ 0.3698, -0.1330, -0.2859],
        [ 0.5953, -0.0618, -0.1414],
        [ 0.6047,  0.0667, -0.4288],
        [ 0.4866,  0.0184, -0.4543],
        [ 0.5706, -0.1880, -0.3860],
        [ 0.5127, -0.0358, -0.2538],
        [ 0.4822,  0.0731, -0.4816],
        [ 0.4987, -0.0328, -0.3646],
        [ 0.5188,  0.0943, -0.3345],
        [ 0.5479, -0.0387, -0.4287],
        [ 0.4772, -0.0953, -0.3610],
        [ 0.4543,  0.0239, -0.4250],
        [ 0.4925, -0.0193, -0.3116],
        [ 0.4881,  0.0524, -0.3530],
        [ 0.4286,  0.0414, -0.2942],
        [ 0.2932,  0.0501, -0.3499],
        [ 0.2562, -0.1798, -0.4440],
        [ 0.4776,  0.0081, -0.4158],
        [ 0.4428, -0.0368, -0.5095],
        [ 0.4709,  0.1389, -0.4180],
        [ 0.5463, -0.1618, -0.2774],
        [ 0.5549,  0.0188, -0.2672],
        [ 0.3573, -0.0309, -0.3028],
        [ 0.5222,  0.1052, -0.3045],
        [ 0.5163, -0.0539, -0.2746],
        [ 0.2647, -0.0816, -0.4079],
        [ 0.4703, -0.0799, -0.3062],
        [ 0.4034, -0.0202, -0.4379],
        [ 0.6166, -0.1884, -0.3265]], device='cuda:0',
       grad_fn=<AddmmBackward0>)
logits_split (tensor([[ 0.2767, -0.0276, -0.3775],
        [ 0.4982, -0.1634, -0.3024],
        [ 0.4199, -0.1065, -0.2961],
        [ 0.4240, -0.2292, -0.4011],
        [ 0.4347,  0.0893, -0.3319]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[ 0.5307,  0.0272, -0.5052],
        [ 0.5598, -0.0311, -0.4045],
        [ 0.4016,  0.1425, -0.4174],
        [ 0.4112,  0.1113, -0.3253]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[ 0.4547, -0.0381, -0.5977],
        [ 0.3406, -0.0881, -0.4271]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[ 0.5988,  0.0357, -0.3656],
        [ 0.4192, -0.1255, -0.5113],
        [ 0.4377,  0.0505, -0.3538],
        [ 0.5238, -0.1894, -0.2511],
        [ 0.4252,  0.2393, -0.4532]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[ 0.7047,  0.0220, -0.2466],
        [ 0.6108, -0.1599, -0.3859],
        [ 0.6109, -0.0045, -0.2741]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[ 0.4751, -0.1734, -0.5666],
        [ 0.4700,  0.0253, -0.3861],
        [ 0.5213, -0.0234, -0.3050],
        [ 0.5400, -0.1319, -0.2371],
        [ 0.3432,  0.0058, -0.6281],
        [ 0.3658, -0.0835, -0.6357],
        [ 0.4206, -0.0313, -0.5518],
        [ 0.4284,  0.0971, -0.4089],
        [ 0.5395,  0.0224, -0.3149],
        [ 0.4548, -0.0440, -0.3283],
        [ 0.5412, -0.0283, -0.6132],
        [ 0.6781,  0.0277, -0.2163],
        [ 0.6869, -0.0999, -0.4217],
        [ 0.4639, -0.0120, -0.2977],
        [ 0.4571, -0.1266, -0.2566],
        [ 0.5883, -0.0385, -0.2506],
        [ 0.5114,  0.1235, -0.3052],
        [ 0.5968, -0.0280, -0.3885],
        [ 0.4460, -0.1532, -0.4096],
        [ 0.4619, -0.0857, -0.5351],
        [ 0.6678, -0.1698, -0.4836]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[ 0.4978, -0.0508, -0.3300],
        [ 0.4817, -0.0994, -0.3177],
        [ 0.4732,  0.0374, -0.5011],
        [ 0.3941,  0.0424, -0.2303],
        [ 0.5044,  0.2759, -0.2278],
        [ 0.5250, -0.0383, -0.2163],
        [ 0.4625,  0.1460, -0.5105],
        [ 0.4351,  0.1178, -0.3369],
        [ 0.4260,  0.0478, -0.2169],
        [ 0.3456, -0.0678, -0.2221],
        [ 0.4959, -0.0856, -0.4403],
        [ 0.5498,  0.0525, -0.2063],
        [ 0.4078,  0.1090, -0.2667],
        [ 0.3698, -0.1330, -0.2859],
        [ 0.5953, -0.0618, -0.1414],
        [ 0.6047,  0.0667, -0.4288],
        [ 0.4866,  0.0184, -0.4543],
        [ 0.5706, -0.1880, -0.3860],
        [ 0.5127, -0.0358, -0.2538],
        [ 0.4822,  0.0731, -0.4816],
        [ 0.4987, -0.0328, -0.3646],
        [ 0.5188,  0.0943, -0.3345],
        [ 0.5479, -0.0387, -0.4287],
        [ 0.4772, -0.0953, -0.3610],
        [ 0.4543,  0.0239, -0.4250],
        [ 0.4925, -0.0193, -0.3116],
        [ 0.4881,  0.0524, -0.3530],
        [ 0.4286,  0.0414, -0.2942],
        [ 0.2932,  0.0501, -0.3499],
        [ 0.2562, -0.1798, -0.4440],
        [ 0.4776,  0.0081, -0.4158],
        [ 0.4428, -0.0368, -0.5095],
        [ 0.4709,  0.1389, -0.4180],
        [ 0.5463, -0.1618, -0.2774],
        [ 0.5549,  0.0188, -0.2672],
        [ 0.3573, -0.0309, -0.3028],
        [ 0.5222,  0.1052, -0.3045],
        [ 0.5163, -0.0539, -0.2746]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[ 0.2647, -0.0816, -0.4079],
        [ 0.4703, -0.0799, -0.3062],
        [ 0.4034, -0.0202, -0.4379],
        [ 0.6166, -0.1884, -0.3265]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>))
pooled_logits tensor([[ 0.4107, -0.0875, -0.3418],
        [ 0.4758,  0.0625, -0.4131],
        [ 0.3977, -0.0631, -0.5124],
        [ 0.4809,  0.0021, -0.3870],
        [ 0.6422, -0.0474, -0.3022],
        [ 0.5075, -0.0442, -0.4067],
        [ 0.4727,  0.0029, -0.3392],
        [ 0.4388, -0.0925, -0.3696]], device='cuda:0', grad_fn=<CatBackward0>)

batch_loss 1.519512414932251
tensor([[  101,  1996,  4111,  ...,  3484,  1524,   102],
        [  101,  1997,  1996,  ..., 12481,  4378,   102],
        [  101,  6295,  1524,  ...,  1523,  5355,   102],
        ...,
        [  101, 16147,  2581,  ...,  2000,  5138,   102],
        [  101,  1996,  3408,  ...,  1012,  1996,   102],
        [  101,  2343,  2003,  ...,  2022, 13371,   102]], device='cuda:0')
tensor([2, 1, 2, 1, 2, 2, 1, 1], device='cuda:0')
logits tensor([[-0.1216, -0.4026,  0.7491],
        [-0.1154, -0.3087,  0.7027],
        [-0.1316, -0.5056,  0.6806],
        [-0.1923, -0.4177,  0.6127],
        [-0.0599, -0.3698,  0.5990],
        [-0.2227, -0.3710,  0.7437],
        [-0.0776, -0.5674,  0.6769],
        [-0.1225, -0.4826,  0.6844],
        [-0.2231, -0.1615,  0.3478],
        [-0.0107, -0.3639,  0.6286],
        [-0.0018, -0.4125,  0.6586],
        [-0.1814, -0.2407,  0.6016],
        [ 0.0675, -0.3366,  0.7158],
        [-0.0912, -0.3784,  0.7252],
        [-0.0361, -0.3977,  0.6150],
        [-0.0563, -0.4447,  0.8521],
        [-0.1075, -0.3174,  0.6610],
        [-0.1180, -0.3940,  0.6499],
        [-0.3437, -0.3486,  0.4743],
        [-0.1750, -0.1674,  0.9903],
        [-0.1198, -0.3976,  0.7694],
        [-0.0718, -0.3346,  0.7750],
        [-0.1273, -0.3535,  0.7607],
        [-0.2257, -0.3090,  0.8347],
        [-0.2456, -0.2255,  0.8233],
        [-0.0778, -0.2495,  0.6738],
        [-0.2125, -0.2917,  0.7891],
        [-0.0459, -0.3322,  0.7004],
        [ 0.1338, -0.4095,  0.8910],
        [-0.1197, -0.3287,  0.5729],
        [-0.2099, -0.2926,  0.6426],
        [-0.3357, -0.3158,  0.6129],
        [-0.1106, -0.3006,  0.6542],
        [ 0.0470, -0.4752,  0.7181],
        [-0.0359, -0.4948,  0.4019],
        [-0.0771, -0.5459,  0.6886],
        [-0.2111, -0.3850,  0.7317],
        [-0.0941, -0.6724,  0.6893],
        [-0.1588, -0.5290,  0.8018],
        [-0.1961, -0.4614,  0.7357],
        [-0.1635, -0.4412,  0.5433],
        [-0.0899, -0.2554,  0.4893],
        [-0.3676, -0.3706,  0.4808],
        [-0.0288, -0.3861,  0.4031],
        [-0.0772, -0.5196,  0.5751],
        [-0.0995, -0.4347,  0.5963],
        [-0.0814, -0.4379,  0.6632],
        [-0.3055, -0.3525,  0.5971],
        [-0.1339, -0.3207,  0.8019],
        [-0.1184, -0.3505,  0.6618],
        [-0.1644, -0.4232,  0.6372],
        [-0.2260, -0.2573,  0.6045],
        [-0.0811, -0.4288,  0.7653],
        [-0.2574, -0.5542,  0.7516],
        [-0.2868, -0.4291,  0.6836],
        [-0.2913, -0.3319,  0.7328],
        [-0.2882, -0.3323,  0.7516],
        [-0.1301, -0.3493,  0.7979]], device='cuda:0',
       grad_fn=<AddmmBackward0>)
logits_split (tensor([[-0.1216, -0.4026,  0.7491],
        [-0.1154, -0.3087,  0.7027],
        [-0.1316, -0.5056,  0.6806],
        [-0.1923, -0.4177,  0.6127],
        [-0.0599, -0.3698,  0.5990],
        [-0.2227, -0.3710,  0.7437],
        [-0.0776, -0.5674,  0.6769],
        [-0.1225, -0.4826,  0.6844],
        [-0.2231, -0.1615,  0.3478],
        [-0.0107, -0.3639,  0.6286],
        [-0.0018, -0.4125,  0.6586],
        [-0.1814, -0.2407,  0.6016]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[ 0.0675, -0.3366,  0.7158],
        [-0.0912, -0.3784,  0.7252],
        [-0.0361, -0.3977,  0.6150],
        [-0.0563, -0.4447,  0.8521],
        [-0.1075, -0.3174,  0.6610],
        [-0.1180, -0.3940,  0.6499],
        [-0.3437, -0.3486,  0.4743]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.1750, -0.1674,  0.9903],
        [-0.1198, -0.3976,  0.7694],
        [-0.0718, -0.3346,  0.7750],
        [-0.1273, -0.3535,  0.7607],
        [-0.2257, -0.3090,  0.8347],
        [-0.2456, -0.2255,  0.8233],
        [-0.0778, -0.2495,  0.6738]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.2125, -0.2917,  0.7891],
        [-0.0459, -0.3322,  0.7004],
        [ 0.1338, -0.4095,  0.8910],
        [-0.1197, -0.3287,  0.5729],
        [-0.2099, -0.2926,  0.6426],
        [-0.3357, -0.3158,  0.6129]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.1106, -0.3006,  0.6542],
        [ 0.0470, -0.4752,  0.7181],
        [-0.0359, -0.4948,  0.4019]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.0771, -0.5459,  0.6886],
        [-0.2111, -0.3850,  0.7317],
        [-0.0941, -0.6724,  0.6893],
        [-0.1588, -0.5290,  0.8018],
        [-0.1961, -0.4614,  0.7357]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.1635, -0.4412,  0.5433],
        [-0.0899, -0.2554,  0.4893],
        [-0.3676, -0.3706,  0.4808],
        [-0.0288, -0.3861,  0.4031],
        [-0.0772, -0.5196,  0.5751],
        [-0.0995, -0.4347,  0.5963]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.0814, -0.4379,  0.6632],
        [-0.3055, -0.3525,  0.5971],
        [-0.1339, -0.3207,  0.8019],
        [-0.1184, -0.3505,  0.6618],
        [-0.1644, -0.4232,  0.6372],
        [-0.2260, -0.2573,  0.6045],
        [-0.0811, -0.4288,  0.7653],
        [-0.2574, -0.5542,  0.7516],
        [-0.2868, -0.4291,  0.6836],
        [-0.2913, -0.3319,  0.7328],
        [-0.2882, -0.3323,  0.7516],
        [-0.1301, -0.3493,  0.7979]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>))
pooled_logits tensor([[-0.1217, -0.3837,  0.6405],
        [-0.0979, -0.3739,  0.6705],
        [-0.1490, -0.2910,  0.8039],
        [-0.1317, -0.3284,  0.7015],
        [-0.0332, -0.4236,  0.5914],
        [-0.1474, -0.5187,  0.7294],
        [-0.1378, -0.4013,  0.5146],
        [-0.1970, -0.3806,  0.7040]], device='cuda:0', grad_fn=<CatBackward0>)

batch_loss 1.1133601665496826
tensor([[  101,  4407,  2038,  ...,  2029,  1996,   102],
        [  101,  4372, 26468,  ...,  1010,  2023,   102],
        [  101,  9311,  2103,  ...,  2489,  6067,   102],
        ...,
        [  101,  5876,  1012,  ...,  2041,  2005,   102],
        [  101,  2010,  2388,  ..., 17298, 13900,   102],
        [  101,  2121,  2097,  ...,  6187,  7100,   102]], device='cuda:0')
tensor([1, 2, 1, 1, 2, 2, 1, 2], device='cuda:0')
logits tensor([[-0.4890,  0.1434,  0.5459],
        [-0.5534,  0.1404,  0.5690],
        [-0.5848,  0.4579,  0.6019],
        [-0.6120,  0.2828,  0.6566],
        [-0.5782,  0.0142,  0.7231],
        [-0.5568,  0.0169,  0.4972],
        [-0.6392,  0.4296,  0.5784],
        [-0.6500,  0.3464,  0.5126],
        [-0.6548,  0.2359,  0.4407],
        [-0.5962,  0.3289,  0.3392],
        [-0.4986,  0.1447,  0.5436],
        [-0.5859,  0.4578,  0.4467],
        [-0.6209,  0.3799,  0.5364],
        [-0.5437,  0.4203,  0.4696],
        [-0.6403,  0.2356,  0.4278],
        [-0.5330,  0.2921,  0.4877],
        [-0.5411,  0.0662,  0.5817],
        [-0.4696,  0.3059,  0.6585],
        [-0.7122,  0.3739,  0.4916],
        [-0.4956,  0.2150,  0.3238],
        [-0.5449,  0.2367,  0.4377],
        [-0.5865,  0.3056,  0.5750],
        [-0.6114,  0.1440,  0.4546],
        [-0.4541,  0.1170,  0.6781],
        [-0.5158,  0.2754,  0.5821],
        [-0.5980,  0.4103,  0.6047],
        [-0.5608,  0.2574,  0.6281],
        [-0.6124,  0.1334,  0.7104],
        [-0.4565,  0.1584,  0.7567],
        [-0.6241,  0.1773,  0.5800],
        [-0.4991,  0.0088,  0.7805],
        [-0.5847, -0.0483,  0.8315],
        [-0.4655,  0.2334,  0.5347],
        [-0.6104,  0.1049,  0.6756],
        [-0.5382,  0.0907,  0.5266],
        [-0.5802,  0.2154,  0.3647],
        [-0.4427,  0.1401,  0.7581],
        [-0.7493,  0.1992,  0.3255],
        [-0.5889,  0.1610,  0.5016],
        [-0.5991,  0.2588,  0.5940],
        [-0.6791,  0.0301,  0.5838],
        [-0.5515,  0.0411,  0.5819],
        [-0.6307,  0.2225,  0.3004],
        [-0.6896,  0.1809,  0.5190],
        [-0.7618,  0.2249,  0.3309],
        [-0.5602,  0.2515,  0.4570],
        [-0.4924,  0.4105,  0.5495],
        [-0.6722,  0.2562,  0.3091],
        [-0.6071,  0.2896,  0.3480],
        [-0.7268,  0.4170,  0.4038],
        [-0.5205,  0.2265,  0.4357],
        [-0.6646,  0.3274,  0.4223],
        [-0.6697,  0.3913,  0.1889],
        [-0.6893,  0.2337,  0.4746],
        [-0.6080,  0.2812,  0.4262],
        [-0.4970,  0.2355,  0.6510],
        [-0.7584,  0.2801,  0.5685],
        [-0.7095,  0.3767,  0.3024],
        [-0.6128,  0.3590,  0.4201],
        [-0.6559,  0.1912,  0.6123],
        [-0.5902,  0.1712,  0.5790],
        [-0.6528,  0.1440,  0.6128],
        [-0.5615,  0.2288,  0.6141],
        [-0.6051,  0.2459,  0.6706],
        [-0.6309,  0.2891,  0.4452],
        [-0.6155,  0.3089,  0.6254],
        [-0.5106,  0.2287,  0.5492],
        [-0.4604,  0.1471,  0.5211],
        [-0.6901,  0.3429,  0.4605],
        [-0.6629,  0.1661,  0.4087],
        [-0.6194,  0.4847,  0.4492],
        [-0.5324,  0.4048,  0.4727],
        [-0.6028,  0.3668,  0.6196],
        [-0.6823,  0.2356,  0.5707],
        [-0.6444,  0.1836,  0.5594],
        [-0.7767,  0.2856,  0.3103],
        [-0.6134,  0.3133,  0.4888],
        [-0.6313,  0.1834,  0.3639],
        [-0.7456,  0.2912,  0.4593],
        [-0.6747,  0.1788,  0.5972],
        [-0.6019,  0.2280,  0.5113],
        [-0.6277,  0.1597,  0.3725],
        [-0.5888,  0.1092,  0.5442],
        [-0.5975,  0.2580,  0.3480],
        [-0.5426,  0.1962,  0.5164],
        [-0.5629,  0.2895,  0.3750],
        [-0.4095,  0.3132,  0.5859],
        [-0.6947, -0.0628,  0.4688],
        [-0.7095,  0.2865,  0.7971],
        [-0.5496,  0.3220,  0.6788],
        [-0.6898,  0.1511,  0.7168],
        [-0.6798,  0.1051,  0.6229],
        [-0.6774,  0.2066,  0.4848],
        [-0.6081,  0.2124,  0.6128],
        [-0.7489,  0.2336,  0.7154],
        [-0.5709,  0.2531,  0.5141],
        [-0.7243,  0.4379,  0.3874],
        [-0.5115,  0.2703,  0.5106],
        [-0.5654,  0.3603,  0.5739],
        [-0.4426,  0.2536,  0.6577],
        [-0.5119,  0.1062,  0.6394],
        [-0.4146,  0.0945,  0.6946],
        [-0.5749,  0.0329,  0.6683],
        [-0.6341,  0.1282,  0.6051],
        [-0.6026,  0.0910,  0.5970],
        [-0.7882, -0.0995,  0.5229],
        [-0.7873,  0.2528,  0.5902],
        [-0.6732,  0.1003,  0.6115]], device='cuda:0',
       grad_fn=<AddmmBackward0>)
logits_split (tensor([[-0.4890,  0.1434,  0.5459],
        [-0.5534,  0.1404,  0.5690],
        [-0.5848,  0.4579,  0.6019],
        [-0.6120,  0.2828,  0.6566],
        [-0.5782,  0.0142,  0.7231],
        [-0.5568,  0.0169,  0.4972],
        [-0.6392,  0.4296,  0.5784],
        [-0.6500,  0.3464,  0.5126],
        [-0.6548,  0.2359,  0.4407],
        [-0.5962,  0.3289,  0.3392],
        [-0.4986,  0.1447,  0.5436],
        [-0.5859,  0.4578,  0.4467],
        [-0.6209,  0.3799,  0.5364],
        [-0.5437,  0.4203,  0.4696],
        [-0.6403,  0.2356,  0.4278],
        [-0.5330,  0.2921,  0.4877],
        [-0.5411,  0.0662,  0.5817],
        [-0.4696,  0.3059,  0.6585],
        [-0.7122,  0.3739,  0.4916],
        [-0.4956,  0.2150,  0.3238],
        [-0.5449,  0.2367,  0.4377],
        [-0.5865,  0.3056,  0.5750],
        [-0.6114,  0.1440,  0.4546],
        [-0.4541,  0.1170,  0.6781],
        [-0.5158,  0.2754,  0.5821],
        [-0.5980,  0.4103,  0.6047],
        [-0.5608,  0.2574,  0.6281]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.6124,  0.1334,  0.7104],
        [-0.4565,  0.1584,  0.7567],
        [-0.6241,  0.1773,  0.5800],
        [-0.4991,  0.0088,  0.7805],
        [-0.5847, -0.0483,  0.8315],
        [-0.4655,  0.2334,  0.5347],
        [-0.6104,  0.1049,  0.6756]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.5382,  0.0907,  0.5266],
        [-0.5802,  0.2154,  0.3647],
        [-0.4427,  0.1401,  0.7581],
        [-0.7493,  0.1992,  0.3255],
        [-0.5889,  0.1610,  0.5016]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.5991,  0.2588,  0.5940],
        [-0.6791,  0.0301,  0.5838],
        [-0.5515,  0.0411,  0.5819],
        [-0.6307,  0.2225,  0.3004],
        [-0.6896,  0.1809,  0.5190],
        [-0.7618,  0.2249,  0.3309],
        [-0.5602,  0.2515,  0.4570],
        [-0.4924,  0.4105,  0.5495],
        [-0.6722,  0.2562,  0.3091],
        [-0.6071,  0.2896,  0.3480],
        [-0.7268,  0.4170,  0.4038],
        [-0.5205,  0.2265,  0.4357],
        [-0.6646,  0.3274,  0.4223],
        [-0.6697,  0.3913,  0.1889],
        [-0.6893,  0.2337,  0.4746],
        [-0.6080,  0.2812,  0.4262],
        [-0.4970,  0.2355,  0.6510],
        [-0.7584,  0.2801,  0.5685],
        [-0.7095,  0.3767,  0.3024],
        [-0.6128,  0.3590,  0.4201],
        [-0.6559,  0.1912,  0.6123],
        [-0.5902,  0.1712,  0.5790],
        [-0.6528,  0.1440,  0.6128],
        [-0.5615,  0.2288,  0.6141],
        [-0.6051,  0.2459,  0.6706],
        [-0.6309,  0.2891,  0.4452],
        [-0.6155,  0.3089,  0.6254],
        [-0.5106,  0.2287,  0.5492],
        [-0.4604,  0.1471,  0.5211],
        [-0.6901,  0.3429,  0.4605],
        [-0.6629,  0.1661,  0.4087],
        [-0.6194,  0.4847,  0.4492],
        [-0.5324,  0.4048,  0.4727],
        [-0.6028,  0.3668,  0.6196],
        [-0.6823,  0.2356,  0.5707],
        [-0.6444,  0.1836,  0.5594],
        [-0.7767,  0.2856,  0.3103],
        [-0.6134,  0.3133,  0.4888],
        [-0.6313,  0.1834,  0.3639],
        [-0.7456,  0.2912,  0.4593],
        [-0.6747,  0.1788,  0.5972],
        [-0.6019,  0.2280,  0.5113],
        [-0.6277,  0.1597,  0.3725],
        [-0.5888,  0.1092,  0.5442],
        [-0.5975,  0.2580,  0.3480],
        [-0.5426,  0.1962,  0.5164],
        [-0.5629,  0.2895,  0.3750],
        [-0.4095,  0.3132,  0.5859]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.6947, -0.0628,  0.4688],
        [-0.7095,  0.2865,  0.7971],
        [-0.5496,  0.3220,  0.6788]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.6898,  0.1511,  0.7168],
        [-0.6798,  0.1051,  0.6229],
        [-0.6774,  0.2066,  0.4848],
        [-0.6081,  0.2124,  0.6128],
        [-0.7489,  0.2336,  0.7154]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.5709,  0.2531,  0.5141],
        [-0.7243,  0.4379,  0.3874],
        [-0.5115,  0.2703,  0.5106],
        [-0.5654,  0.3603,  0.5739]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.4426,  0.2536,  0.6577],
        [-0.5119,  0.1062,  0.6394],
        [-0.4146,  0.0945,  0.6946],
        [-0.5749,  0.0329,  0.6683],
        [-0.6341,  0.1282,  0.6051],
        [-0.6026,  0.0910,  0.5970],
        [-0.7882, -0.0995,  0.5229],
        [-0.7873,  0.2528,  0.5902],
        [-0.6732,  0.1003,  0.6115]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>))
pooled_logits tensor([[-0.5714,  0.2605,  0.5331],
        [-0.5504,  0.1097,  0.6956],
        [-0.5799,  0.1613,  0.4953],
        [-0.6206,  0.2550,  0.4815],
        [-0.6513,  0.1819,  0.6483],
        [-0.6808,  0.1818,  0.6305],
        [-0.5930,  0.3304,  0.4965],
        [-0.6033,  0.1067,  0.6207]], device='cuda:0', grad_fn=<CatBackward0>)

batch_loss 0.8221977353096008
tensor([[  101,  7112,  5061,  ...,  1012,  2009,   102],
        [  101,  4972,  2066,  ...,  4668,  2124,   102],
        [  101,  2004,  6778,  ...,  4667,  2010,   102],
        ...,
        [  101,  2807,  1010,  ...,  4352,  2033,   102],
        [  101,  2000,  2156,  ..., 12857,  1010,   102],
        [  101,  1524, 23401,  ...,  2979,  1999,   102]], device='cuda:0')
tensor([1, 1, 0, 1], device='cuda:0')
logits tensor([[-0.8999,  0.8120,  0.2908],
        [-0.8256,  0.4750,  0.3583],
        [-0.8601,  0.3688,  0.4728],
        [-0.7746,  0.4612,  0.4654],
        [-0.9415,  0.4317,  0.3436],
        [-0.9002,  0.5471,  0.2522],
        [-0.8916,  0.5263,  0.4074],
        [-0.7286,  0.7477,  0.4726],
        [-0.8100,  0.5407,  0.3803],
        [-0.9901,  0.4901,  0.3000],
        [-0.8697,  0.5811,  0.4038],
        [-0.8580,  0.4672,  0.4559],
        [-0.8301,  0.6604,  0.2702],
        [-0.9973,  0.5632,  0.2850],
        [-0.9905,  0.4357,  0.4343],
        [-0.8803,  0.5617,  0.4833],
        [-0.7931,  0.4354,  0.5500],
        [-0.8290,  0.5657,  0.6266],
        [-0.8646,  0.5784,  0.5626],
        [-0.7841,  0.5188,  0.4522],
        [-0.9773,  0.8100,  0.4036],
        [-0.8800,  0.6408,  0.5027],
        [-0.6911,  0.4233,  0.5125],
        [-0.7170,  0.5883,  0.4729],
        [-0.6958,  0.4794,  0.4593],
        [-0.8390,  0.2768,  0.4967],
        [-0.7645,  0.6115,  0.5914],
        [-0.6110,  0.6778,  0.4548],
        [-0.8789,  0.3888,  0.4495],
        [-0.7924,  0.5205,  0.6010],
        [-0.8621,  0.6098,  0.4994],
        [-0.8020,  0.6312,  0.3642],
        [-0.7460,  0.5968,  0.4925],
        [-0.8687,  0.6208,  0.4192],
        [-0.7822,  0.6431,  0.4279],
        [-0.7716,  0.8100,  0.3399],
        [-0.7213,  0.4743,  0.3566],
        [-0.7617,  0.5190,  0.3801],
        [-0.8655,  0.4493,  0.3782],
        [-0.6671,  0.4473,  0.4961],
        [-0.7123,  0.3247,  0.2787],
        [-0.6584,  0.1664,  0.4447],
        [-0.6946,  0.4272,  0.3606],
        [-0.7206,  0.3422,  0.2769],
        [-0.6634,  0.4297,  0.2733],
        [-0.8286,  0.4318,  0.3135],
        [-0.7734,  0.4402,  0.4771],
        [-0.6863,  0.5461,  0.4129],
        [-0.7579,  0.4589,  0.6144],
        [-0.8756,  0.4371,  0.6669],
        [-0.7367,  0.4938,  0.5977],
        [-0.8555,  0.4374,  0.6856]], device='cuda:0',
       grad_fn=<AddmmBackward0>)
logits_split (tensor([[-0.8999,  0.8120,  0.2908],
        [-0.8256,  0.4750,  0.3583],
        [-0.8601,  0.3688,  0.4728],
        [-0.7746,  0.4612,  0.4654],
        [-0.9415,  0.4317,  0.3436],
        [-0.9002,  0.5471,  0.2522],
        [-0.8916,  0.5263,  0.4074],
        [-0.7286,  0.7477,  0.4726],
        [-0.8100,  0.5407,  0.3803],
        [-0.9901,  0.4901,  0.3000],
        [-0.8697,  0.5811,  0.4038],
        [-0.8580,  0.4672,  0.4559],
        [-0.8301,  0.6604,  0.2702],
        [-0.9973,  0.5632,  0.2850],
        [-0.9905,  0.4357,  0.4343]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.8803,  0.5617,  0.4833],
        [-0.7931,  0.4354,  0.5500],
        [-0.8290,  0.5657,  0.6266],
        [-0.8646,  0.5784,  0.5626],
        [-0.7841,  0.5188,  0.4522],
        [-0.9773,  0.8100,  0.4036],
        [-0.8800,  0.6408,  0.5027],
        [-0.6911,  0.4233,  0.5125],
        [-0.7170,  0.5883,  0.4729],
        [-0.6958,  0.4794,  0.4593],
        [-0.8390,  0.2768,  0.4967],
        [-0.7645,  0.6115,  0.5914],
        [-0.6110,  0.6778,  0.4548],
        [-0.8789,  0.3888,  0.4495],
        [-0.7924,  0.5205,  0.6010],
        [-0.8621,  0.6098,  0.4994],
        [-0.8020,  0.6312,  0.3642],
        [-0.7460,  0.5968,  0.4925],
        [-0.8687,  0.6208,  0.4192],
        [-0.7822,  0.6431,  0.4279],
        [-0.7716,  0.8100,  0.3399],
        [-0.7213,  0.4743,  0.3566],
        [-0.7617,  0.5190,  0.3801],
        [-0.8655,  0.4493,  0.3782]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.6671,  0.4473,  0.4961],
        [-0.7123,  0.3247,  0.2787],
        [-0.6584,  0.1664,  0.4447],
        [-0.6946,  0.4272,  0.3606],
        [-0.7206,  0.3422,  0.2769],
        [-0.6634,  0.4297,  0.2733],
        [-0.8286,  0.4318,  0.3135],
        [-0.7734,  0.4402,  0.4771]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.6863,  0.5461,  0.4129],
        [-0.7579,  0.4589,  0.6144],
        [-0.8756,  0.4371,  0.6669],
        [-0.7367,  0.4938,  0.5977],
        [-0.8555,  0.4374,  0.6856]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>))
pooled_logits tensor([[-0.8779,  0.5406,  0.3728],
        [-0.7991,  0.5597,  0.4699],
        [-0.7148,  0.3762,  0.3651],
        [-0.7824,  0.4746,  0.5955]], device='cuda:0', grad_fn=<CatBackward0>)

batch_loss 1.5252314805984497
total_loss nan
Training loss: nan
Validation loss: nan

------------------------- Epoch 3 -------------------------
tensor([[  101,  3513, 23802,  ...,  2092,  1011,   102],
        [  101, 10959,  2000,  ...,  7300, 13965,   102],
        [  101,  1011, 13115,  ..., 19153,  1998,   102],
        ...,
        [  101,  1012,  2009,  ...,  2138,  2057,   102],
        [  101,  2024,  2092,  ..., 17258,  9259,   102],
        [  101,  3303,  3571,  ..., 16939,  1010,   102]], device='cuda:0')
tensor([2, 1, 0, 1, 2, 1, 0, 1], device='cuda:0')
logits tensor([[-1.0881e-01,  4.4755e-01, -9.2600e-02],
        [-8.1340e-02,  5.1895e-01, -5.1067e-02],
        [-3.2876e-01,  4.7343e-01, -1.9457e-01],
        [-1.4326e-01,  3.9543e-01, -1.1301e-01],
        [-1.3222e-01,  3.3355e-01, -3.2661e-01],
        [-8.2402e-02,  2.6891e-01, -1.1828e-01],
        [-1.7061e-01,  4.0150e-01, -2.5408e-01],
        [-1.4198e-01,  2.6601e-01, -9.0699e-02],
        [-2.7665e-01,  3.6284e-01, -2.5076e-01],
        [-1.2471e-01,  3.8369e-01, -9.0995e-02],
        [-1.4505e-01,  2.0867e-01, -4.7547e-02],
        [-8.2126e-02,  2.2989e-01,  5.6379e-02],
        [-2.4519e-01,  2.3987e-01,  7.6458e-02],
        [-8.2231e-02,  3.9028e-01, -1.8060e-01],
        [-2.0356e-01,  4.0011e-01, -1.7685e-02],
        [-2.5172e-01,  4.9882e-01, -5.5266e-02],
        [-1.0946e-01,  3.8099e-01, -1.4130e-01],
        [-1.2132e-01,  3.5044e-01, -1.2553e-01],
        [-1.6381e-01,  4.7477e-01, -1.9588e-01],
        [-3.2836e-02,  4.7623e-01, -1.8027e-01],
        [-1.9355e-02,  3.6731e-01, -1.0879e-01],
        [-7.5635e-02,  4.7000e-01, -2.5582e-01],
        [ 1.1511e-01,  2.2023e-01, -1.8500e-01],
        [-7.7843e-02,  2.8219e-01, -7.6878e-02],
        [-1.5204e-01,  2.6111e-02, -1.4823e-01],
        [ 8.5219e-02, -4.0908e-02, -1.3145e-01],
        [-1.2659e-01,  2.6253e-01,  8.4070e-02],
        [-1.4658e-01,  2.9585e-01, -1.0904e-01],
        [-1.1746e-01,  2.5998e-01, -5.9154e-02],
        [-5.7944e-02,  2.9100e-01, -1.5522e-01],
        [-7.3212e-02,  2.7137e-01, -2.2607e-01],
        [-1.7916e-01,  1.9620e-01, -9.8862e-02],
        [-1.0862e-01,  2.2823e-01, -1.0624e-01],
        [-1.1588e-01,  4.1729e-01, -2.2842e-01],
        [ 7.6188e-03,  2.6788e-01,  2.0813e-02],
        [ 7.7901e-02,  2.9983e-01,  2.4762e-02],
        [-2.8798e-02,  4.3596e-01,  9.2932e-02],
        [-2.4841e-02,  4.1970e-01, -1.5835e-02],
        [-1.5201e-01,  3.1598e-01, -6.7625e-02],
        [-2.3828e-02,  3.6546e-01,  4.9265e-02],
        [-2.4765e-02,  4.9336e-01,  6.7971e-02],
        [-5.7152e-02,  4.3112e-01,  1.3631e-01],
        [-2.7929e-02,  5.5196e-01, -1.0932e-01],
        [-1.4295e-01,  5.9438e-01, -9.9402e-02],
        [-2.4053e-01,  5.0918e-01,  8.1425e-02],
        [ 1.8954e-01,  4.3818e-01, -1.9793e-01],
        [-1.8863e-01,  3.4606e-01, -3.3179e-02],
        [-1.1201e-02,  4.7877e-01, -3.5491e-02],
        [-2.9464e-04,  3.4404e-01, -7.4068e-02],
        [-7.0783e-02,  5.0316e-01, -1.4754e-01],
        [-3.0172e-02,  4.6778e-01,  6.1219e-02],
        [-1.5229e-01,  4.5987e-01, -1.8856e-01],
        [-2.1374e-01,  3.5959e-01, -5.4531e-03],
        [-1.4800e-01,  3.5289e-01, -2.6170e-01],
        [-2.6599e-01,  3.6019e-01, -2.6777e-01],
        [-1.4425e-01,  5.7506e-01, -1.2302e-01],
        [ 3.3087e-02,  5.9332e-01, -1.9379e-01],
        [-2.2880e-01,  3.6614e-01, -1.8237e-01],
        [-2.2213e-01,  3.4516e-01, -1.6821e-01],
        [-1.5752e-01,  4.7114e-01, -2.0405e-01],
        [-1.8635e-01,  3.7820e-01, -1.9726e-01],
        [-2.3470e-01,  3.6515e-01, -1.6291e-01],
        [-1.6198e-01,  4.4655e-01, -3.2349e-01],
        [-1.8325e-01,  4.2419e-01, -2.4285e-01],
        [-2.0177e-01,  3.6706e-01, -1.6219e-01],
        [-1.9717e-01,  3.6766e-01, -1.5811e-01],
        [-1.3020e-01,  4.6527e-01, -1.7002e-01],
        [-2.5680e-01,  3.8528e-01, -9.8359e-02],
        [-1.5500e-01,  4.0222e-01, -2.0022e-01],
        [-3.5119e-01,  3.9656e-01, -1.9479e-01],
        [-1.7621e-01,  4.0443e-01, -2.2286e-01],
        [-3.2108e-01,  4.3288e-01, -1.6255e-01],
        [-1.7371e-01,  5.1372e-01, -2.1658e-01],
        [-1.7928e-01,  4.8597e-01, -1.1335e-01],
        [-1.4164e-01,  3.4835e-01, -2.2359e-01],
        [-2.1951e-01,  3.6674e-01, -2.7323e-01],
        [-2.3982e-01,  4.9394e-01, -2.4646e-01],
        [-2.9390e-01,  4.4263e-01, -3.3549e-01],
        [ 1.9653e-01,  1.2386e-01, -2.4167e-01],
        [ 3.4852e-01,  2.7302e-01, -2.6093e-02],
        [ 2.0664e-01,  7.3719e-02, -1.7525e-01],
        [-9.2577e-02,  4.0825e-01, -1.0864e-01],
        [ 6.8819e-02,  3.2621e-01, -1.0087e-01],
        [ 1.2319e-01,  2.1889e-01, -5.0474e-02],
        [-4.5266e-02,  2.7271e-01, -1.6469e-01],
        [ 2.8295e-02,  2.4152e-01, -1.4532e-01],
        [-2.0519e-02,  1.8191e-01, -6.8594e-02],
        [ 1.1754e-01,  3.3599e-01, -2.4503e-01]], device='cuda:0',
       grad_fn=<AddmmBackward0>)
logits_split (tensor([[-0.1088,  0.4476, -0.0926],
        [-0.0813,  0.5189, -0.0511],
        [-0.3288,  0.4734, -0.1946],
        [-0.1433,  0.3954, -0.1130],
        [-0.1322,  0.3335, -0.3266],
        [-0.0824,  0.2689, -0.1183],
        [-0.1706,  0.4015, -0.2541],
        [-0.1420,  0.2660, -0.0907],
        [-0.2766,  0.3628, -0.2508],
        [-0.1247,  0.3837, -0.0910],
        [-0.1451,  0.2087, -0.0475],
        [-0.0821,  0.2299,  0.0564],
        [-0.2452,  0.2399,  0.0765],
        [-0.0822,  0.3903, -0.1806],
        [-0.2036,  0.4001, -0.0177],
        [-0.2517,  0.4988, -0.0553],
        [-0.1095,  0.3810, -0.1413],
        [-0.1213,  0.3504, -0.1255],
        [-0.1638,  0.4748, -0.1959],
        [-0.0328,  0.4762, -0.1803],
        [-0.0194,  0.3673, -0.1088],
        [-0.0756,  0.4700, -0.2558]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([], device='cuda:0', size=(0, 3), grad_fn=<SplitWithSizesBackward0>), tensor([[ 0.1151,  0.2202, -0.1850],
        [-0.0778,  0.2822, -0.0769],
        [-0.1520,  0.0261, -0.1482],
        [ 0.0852, -0.0409, -0.1314]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.1266,  0.2625,  0.0841],
        [-0.1466,  0.2958, -0.1090],
        [-0.1175,  0.2600, -0.0592],
        [-0.0579,  0.2910, -0.1552],
        [-0.0732,  0.2714, -0.2261],
        [-0.1792,  0.1962, -0.0989]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-1.0862e-01,  2.2823e-01, -1.0624e-01],
        [-1.1588e-01,  4.1729e-01, -2.2842e-01],
        [ 7.6188e-03,  2.6788e-01,  2.0813e-02],
        [ 7.7901e-02,  2.9983e-01,  2.4762e-02],
        [-2.8798e-02,  4.3596e-01,  9.2932e-02],
        [-2.4841e-02,  4.1970e-01, -1.5835e-02],
        [-1.5201e-01,  3.1598e-01, -6.7625e-02],
        [-2.3828e-02,  3.6546e-01,  4.9265e-02],
        [-2.4765e-02,  4.9336e-01,  6.7971e-02],
        [-5.7152e-02,  4.3112e-01,  1.3631e-01],
        [-2.7929e-02,  5.5196e-01, -1.0932e-01],
        [-1.4295e-01,  5.9438e-01, -9.9402e-02],
        [-2.4053e-01,  5.0918e-01,  8.1425e-02],
        [ 1.8954e-01,  4.3818e-01, -1.9793e-01],
        [-1.8863e-01,  3.4606e-01, -3.3179e-02],
        [-1.1201e-02,  4.7877e-01, -3.5491e-02],
        [-2.9464e-04,  3.4404e-01, -7.4068e-02],
        [-7.0783e-02,  5.0316e-01, -1.4754e-01],
        [-3.0172e-02,  4.6778e-01,  6.1219e-02],
        [-1.5229e-01,  4.5987e-01, -1.8856e-01],
        [-2.1374e-01,  3.5959e-01, -5.4531e-03],
        [-1.4800e-01,  3.5289e-01, -2.6170e-01],
        [-2.6599e-01,  3.6019e-01, -2.6777e-01]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.1442,  0.5751, -0.1230],
        [ 0.0331,  0.5933, -0.1938],
        [-0.2288,  0.3661, -0.1824],
        [-0.2221,  0.3452, -0.1682],
        [-0.1575,  0.4711, -0.2040],
        [-0.1864,  0.3782, -0.1973],
        [-0.2347,  0.3651, -0.1629],
        [-0.1620,  0.4465, -0.3235],
        [-0.1832,  0.4242, -0.2429],
        [-0.2018,  0.3671, -0.1622],
        [-0.1972,  0.3677, -0.1581],
        [-0.1302,  0.4653, -0.1700],
        [-0.2568,  0.3853, -0.0984],
        [-0.1550,  0.4022, -0.2002],
        [-0.3512,  0.3966, -0.1948],
        [-0.1762,  0.4044, -0.2229],
        [-0.3211,  0.4329, -0.1626],
        [-0.1737,  0.5137, -0.2166],
        [-0.1793,  0.4860, -0.1133],
        [-0.1416,  0.3484, -0.2236],
        [-0.2195,  0.3667, -0.2732],
        [-0.2398,  0.4939, -0.2465],
        [-0.2939,  0.4426, -0.3355]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[ 0.1965,  0.1239, -0.2417],
        [ 0.3485,  0.2730, -0.0261],
        [ 0.2066,  0.0737, -0.1752]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.0926,  0.4083, -0.1086],
        [ 0.0688,  0.3262, -0.1009],
        [ 0.1232,  0.2189, -0.0505],
        [-0.0453,  0.2727, -0.1647],
        [ 0.0283,  0.2415, -0.1453],
        [-0.0205,  0.1819, -0.0686],
        [ 0.1175,  0.3360, -0.2450]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>))
pooled_logits tensor([[-0.1420,  0.3791, -0.1254],
        [    nan,     nan,     nan],
        [-0.0074,  0.1219, -0.1354],
        [-0.1168,  0.2628, -0.0940],
        [-0.0762,  0.4105, -0.0567],
        [-0.1967,  0.4277, -0.1989],
        [ 0.2506,  0.1569, -0.1477],
        [ 0.0256,  0.2836, -0.1262]], device='cuda:0', grad_fn=<CatBackward0>)

batch_loss nan
tensor([[  101,  9962,  4402,  ...,  5653,  1010,   102],
        [  101,  2030, 20905,  ...,  2006,  2602,   102],
        [  101,  2154,  2349,  ...,  2077,  1996,   102],
        ...,
        [  101,  2280,  2343,  ..., 11828,  2050,   102],
        [  101,  3049,  2000,  ...,  5905,  1997,   102],
        [  101,  1000,  1037,  ...,  2506,  1012,   102]], device='cuda:0')
tensor([2, 2, 2, 2, 2, 1, 2, 2], device='cuda:0')
logits tensor([[ 0.1115,  0.2367, -0.0769],
        [ 0.2655, -0.2410, -0.1009],
        [ 0.3069, -0.0870,  0.0626],
        [ 0.1850, -0.0534, -0.1398],
        [ 0.3605,  0.0339, -0.0374],
        [ 0.2392,  0.1722, -0.2890],
        [ 0.4245, -0.0020, -0.0497],
        [ 0.1066,  0.2330, -0.1231],
        [ 0.2187,  0.0280, -0.1788],
        [ 0.4007,  0.0088, -0.2985],
        [ 0.0647,  0.1067, -0.1510],
        [ 0.5218,  0.0033, -0.1442],
        [ 0.2334, -0.1534, -0.2065],
        [ 0.2369,  0.1445, -0.1150],
        [ 0.2217, -0.0077, -0.0040],
        [ 0.1137,  0.3338, -0.2055],
        [ 0.4342,  0.0297,  0.0646],
        [ 0.3289, -0.0161, -0.1317],
        [ 0.4085,  0.1388, -0.0461],
        [ 0.2907, -0.0340, -0.4041],
        [ 0.3245,  0.1405, -0.2451],
        [ 0.3141,  0.1531, -0.2107],
        [ 0.3272,  0.1261, -0.2529],
        [ 0.2912,  0.1050, -0.4894],
        [ 0.3463,  0.2422, -0.4445],
        [ 0.2383,  0.0396, -0.4420],
        [ 0.1602,  0.2137, -0.2576],
        [ 0.3749,  0.2282, -0.1488],
        [ 0.3197,  0.0121, -0.1926],
        [ 0.3335,  0.1001, -0.4521],
        [ 0.3897,  0.1598, -0.3715],
        [ 0.4815,  0.2139, -0.3618],
        [ 0.3145, -0.0102, -0.2402],
        [ 0.2975,  0.1621, -0.1607],
        [ 0.4229,  0.1711, -0.2894],
        [ 0.3252,  0.1610, -0.1860],
        [ 0.4480,  0.0849, -0.2980],
        [ 0.3080,  0.0678, -0.2332],
        [ 0.2854,  0.0358, -0.2367],
        [ 0.3989,  0.0258, -0.2945],
        [ 0.4000,  0.0024, -0.1885],
        [ 0.3324,  0.1196, -0.1576],
        [ 0.3874,  0.1550, -0.2750],
        [ 0.1854,  0.2261, -0.2344],
        [ 0.3268,  0.2753, -0.1866],
        [ 0.4223,  0.1227, -0.1228],
        [ 0.4022,  0.2962, -0.3641],
        [ 0.2033,  0.3093, -0.0456],
        [ 0.2212,  0.1873,  0.0124],
        [ 0.3320,  0.0654, -0.1517],
        [ 0.3799,  0.1109, -0.2690],
        [ 0.2221,  0.2705,  0.0449],
        [ 0.1481,  0.3542, -0.1635],
        [ 0.2278,  0.1751, -0.1812],
        [ 0.4610,  0.0825, -0.1795],
        [ 0.4667,  0.1047, -0.2598],
        [ 0.2631,  0.1033, -0.2596],
        [ 0.3166, -0.1250, -0.2249],
        [ 0.2639,  0.0937, -0.1188],
        [ 0.3529,  0.2218, -0.3944],
        [ 0.2362,  0.1820, -0.2943],
        [ 0.3178,  0.2666, -0.3701],
        [ 0.3039,  0.1066, -0.3529],
        [ 0.1462,  0.1046, -0.2562],
        [ 0.2667,  0.1628, -0.3295],
        [ 0.3476,  0.1989, -0.1242],
        [ 0.2700,  0.2236, -0.2751],
        [ 0.2902,  0.2071, -0.0882],
        [ 0.1722,  0.3059, -0.2168],
        [ 0.1494, -0.0782, -0.2173],
        [ 0.2880,  0.0146, -0.2141],
        [ 0.2688,  0.2729, -0.2997],
        [ 0.3865,  0.3573, -0.3049],
        [ 0.4546, -0.0174, -0.1975],
        [ 0.2666,  0.2389, -0.2748],
        [ 0.1729, -0.0614, -0.2700],
        [ 0.2937,  0.2767, -0.2214],
        [ 0.3359, -0.0174, -0.1556],
        [ 0.1567,  0.0858, -0.0927],
        [ 0.2276, -0.2105, -0.1548],
        [ 0.1538,  0.0534, -0.2318],
        [ 0.4270, -0.0667, -0.0998]], device='cuda:0',
       grad_fn=<AddmmBackward0>)
logits_split (tensor([[ 0.1115,  0.2367, -0.0769],
        [ 0.2655, -0.2410, -0.1009],
        [ 0.3069, -0.0870,  0.0626],
        [ 0.1850, -0.0534, -0.1398],
        [ 0.3605,  0.0339, -0.0374]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[ 0.2392,  0.1722, -0.2890],
        [ 0.4245, -0.0020, -0.0497],
        [ 0.1066,  0.2330, -0.1231],
        [ 0.2187,  0.0280, -0.1788]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[ 0.4007,  0.0088, -0.2985],
        [ 0.0647,  0.1067, -0.1510]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[ 0.5218,  0.0033, -0.1442],
        [ 0.2334, -0.1534, -0.2065],
        [ 0.2369,  0.1445, -0.1150],
        [ 0.2217, -0.0077, -0.0040],
        [ 0.1137,  0.3338, -0.2055]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[ 0.4342,  0.0297,  0.0646],
        [ 0.3289, -0.0161, -0.1317],
        [ 0.4085,  0.1388, -0.0461]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[ 0.2907, -0.0340, -0.4041],
        [ 0.3245,  0.1405, -0.2451],
        [ 0.3141,  0.1531, -0.2107],
        [ 0.3272,  0.1261, -0.2529],
        [ 0.2912,  0.1050, -0.4894],
        [ 0.3463,  0.2422, -0.4445],
        [ 0.2383,  0.0396, -0.4420],
        [ 0.1602,  0.2137, -0.2576],
        [ 0.3749,  0.2282, -0.1488],
        [ 0.3197,  0.0121, -0.1926],
        [ 0.3335,  0.1001, -0.4521],
        [ 0.3897,  0.1598, -0.3715],
        [ 0.4815,  0.2139, -0.3618],
        [ 0.3145, -0.0102, -0.2402],
        [ 0.2975,  0.1621, -0.1607],
        [ 0.4229,  0.1711, -0.2894],
        [ 0.3252,  0.1610, -0.1860],
        [ 0.4480,  0.0849, -0.2980],
        [ 0.3080,  0.0678, -0.2332],
        [ 0.2854,  0.0358, -0.2367],
        [ 0.3989,  0.0258, -0.2945]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[ 0.4000,  0.0024, -0.1885],
        [ 0.3324,  0.1196, -0.1576],
        [ 0.3874,  0.1550, -0.2750],
        [ 0.1854,  0.2261, -0.2344],
        [ 0.3268,  0.2753, -0.1866],
        [ 0.4223,  0.1227, -0.1228],
        [ 0.4022,  0.2962, -0.3641],
        [ 0.2033,  0.3093, -0.0456],
        [ 0.2212,  0.1873,  0.0124],
        [ 0.3320,  0.0654, -0.1517],
        [ 0.3799,  0.1109, -0.2690],
        [ 0.2221,  0.2705,  0.0449],
        [ 0.1481,  0.3542, -0.1635],
        [ 0.2278,  0.1751, -0.1812],
        [ 0.4610,  0.0825, -0.1795],
        [ 0.4667,  0.1047, -0.2598],
        [ 0.2631,  0.1033, -0.2596],
        [ 0.3166, -0.1250, -0.2249],
        [ 0.2639,  0.0937, -0.1188],
        [ 0.3529,  0.2218, -0.3944],
        [ 0.2362,  0.1820, -0.2943],
        [ 0.3178,  0.2666, -0.3701],
        [ 0.3039,  0.1066, -0.3529],
        [ 0.1462,  0.1046, -0.2562],
        [ 0.2667,  0.1628, -0.3295],
        [ 0.3476,  0.1989, -0.1242],
        [ 0.2700,  0.2236, -0.2751],
        [ 0.2902,  0.2071, -0.0882],
        [ 0.1722,  0.3059, -0.2168],
        [ 0.1494, -0.0782, -0.2173],
        [ 0.2880,  0.0146, -0.2141],
        [ 0.2688,  0.2729, -0.2997],
        [ 0.3865,  0.3573, -0.3049],
        [ 0.4546, -0.0174, -0.1975],
        [ 0.2666,  0.2389, -0.2748],
        [ 0.1729, -0.0614, -0.2700],
        [ 0.2937,  0.2767, -0.2214],
        [ 0.3359, -0.0174, -0.1556]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[ 0.1567,  0.0858, -0.0927],
        [ 0.2276, -0.2105, -0.1548],
        [ 0.1538,  0.0534, -0.2318],
        [ 0.4270, -0.0667, -0.0998]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>))
pooled_logits tensor([[ 0.2459, -0.0222, -0.0585],
        [ 0.2473,  0.1078, -0.1602],
        [ 0.2327,  0.0577, -0.2247],
        [ 0.2655,  0.0641, -0.1350],
        [ 0.3905,  0.0508, -0.0377],
        [ 0.3330,  0.1142, -0.2958],
        [ 0.2969,  0.1551, -0.2153],
        [ 0.2413, -0.0345, -0.1448]], device='cuda:0', grad_fn=<CatBackward0>)

batch_loss 1.2836164236068726
tensor([[  101,  1996,  4111,  ...,  3484,  1524,   102],
        [  101,  1997,  1996,  ..., 12481,  4378,   102],
        [  101,  6295,  1524,  ...,  1523,  5355,   102],
        ...,
        [  101, 16147,  2581,  ...,  2000,  5138,   102],
        [  101,  1996,  3408,  ...,  1012,  1996,   102],
        [  101,  2343,  2003,  ...,  2022, 13371,   102]], device='cuda:0')
tensor([2, 1, 2, 1, 2, 2, 1, 1], device='cuda:0')
logits tensor([[-0.1975, -0.3623,  0.6067],
        [ 0.0151, -0.2721,  0.5440],
        [-0.1849, -0.3385,  0.6365],
        [-0.1197, -0.3695,  0.3472],
        [-0.1151, -0.3026,  0.4350],
        [-0.2378, -0.2639,  0.5717],
        [-0.0528, -0.4718,  0.6108],
        [-0.0600, -0.1518,  0.6446],
        [-0.3652, -0.0592,  0.2031],
        [ 0.0861, -0.2989,  0.4499],
        [ 0.0396, -0.2840,  0.4436],
        [ 0.0550, -0.1413,  0.3967],
        [ 0.0968, -0.1403,  0.5462],
        [ 0.0299, -0.2274,  0.5709],
        [ 0.0290, -0.2193,  0.4765],
        [-0.0359, -0.3174,  0.7625],
        [-0.0514, -0.1502,  0.5148],
        [-0.0082, -0.2687,  0.4873],
        [-0.3468, -0.2340,  0.2804],
        [-0.2501, -0.2313,  0.9276],
        [-0.0818, -0.2986,  0.7915],
        [ 0.0072, -0.2641,  0.7262],
        [-0.0741, -0.4168,  0.5792],
        [-0.1865, -0.3249,  0.9363],
        [-0.2241, -0.3980,  0.8140],
        [-0.0687, -0.1388,  0.6176],
        [-0.0954, -0.2086,  0.5718],
        [ 0.0421, -0.0984,  0.5463],
        [ 0.2366, -0.3214,  0.5821],
        [-0.1796, -0.1584,  0.4869],
        [-0.1806, -0.1235,  0.4931],
        [-0.2858,  0.0434,  0.3775],
        [-0.1995, -0.0304,  0.4619],
        [ 0.0458, -0.5049,  0.6730],
        [-0.0025, -0.4418,  0.2835],
        [-0.0682, -0.5547,  0.6645],
        [-0.0854, -0.3871,  0.5754],
        [-0.0395, -0.4829,  0.6324],
        [-0.1686, -0.4251,  0.6200],
        [-0.0888, -0.4286,  0.5410],
        [-0.0468, -0.1978,  0.4473],
        [-0.0066, -0.1656,  0.2925],
        [-0.2766, -0.1770,  0.4195],
        [ 0.1286, -0.2742,  0.2960],
        [ 0.2211, -0.2445,  0.3558],
        [-0.0276, -0.1316,  0.2276],
        [-0.0776, -0.1543,  0.4971],
        [-0.3964, -0.2831,  0.4038],
        [-0.1101, -0.0751,  0.5189],
        [-0.1410, -0.1588,  0.5431],
        [-0.2335, -0.1682,  0.4944],
        [-0.1178, -0.1816,  0.4807],
        [ 0.0687, -0.1642,  0.5610],
        [-0.1514, -0.5600,  0.5158],
        [-0.2011, -0.1505,  0.5323],
        [-0.2102, -0.3127,  0.5199],
        [-0.2226, -0.1435,  0.5209],
        [-0.0395, -0.1885,  0.6084]], device='cuda:0',
       grad_fn=<AddmmBackward0>)
logits_split (tensor([[-0.1975, -0.3623,  0.6067],
        [ 0.0151, -0.2721,  0.5440],
        [-0.1849, -0.3385,  0.6365],
        [-0.1197, -0.3695,  0.3472],
        [-0.1151, -0.3026,  0.4350],
        [-0.2378, -0.2639,  0.5717],
        [-0.0528, -0.4718,  0.6108],
        [-0.0600, -0.1518,  0.6446],
        [-0.3652, -0.0592,  0.2031],
        [ 0.0861, -0.2989,  0.4499],
        [ 0.0396, -0.2840,  0.4436],
        [ 0.0550, -0.1413,  0.3967]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[ 0.0968, -0.1403,  0.5462],
        [ 0.0299, -0.2274,  0.5709],
        [ 0.0290, -0.2193,  0.4765],
        [-0.0359, -0.3174,  0.7625],
        [-0.0514, -0.1502,  0.5148],
        [-0.0082, -0.2687,  0.4873],
        [-0.3468, -0.2340,  0.2804]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.2501, -0.2313,  0.9276],
        [-0.0818, -0.2986,  0.7915],
        [ 0.0072, -0.2641,  0.7262],
        [-0.0741, -0.4168,  0.5792],
        [-0.1865, -0.3249,  0.9363],
        [-0.2241, -0.3980,  0.8140],
        [-0.0687, -0.1388,  0.6176]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.0954, -0.2086,  0.5718],
        [ 0.0421, -0.0984,  0.5463],
        [ 0.2366, -0.3214,  0.5821],
        [-0.1796, -0.1584,  0.4869],
        [-0.1806, -0.1235,  0.4931],
        [-0.2858,  0.0434,  0.3775]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.1995, -0.0304,  0.4619],
        [ 0.0458, -0.5049,  0.6730],
        [-0.0025, -0.4418,  0.2835]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.0682, -0.5547,  0.6645],
        [-0.0854, -0.3871,  0.5754],
        [-0.0395, -0.4829,  0.6324],
        [-0.1686, -0.4251,  0.6200],
        [-0.0888, -0.4286,  0.5410]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.0468, -0.1978,  0.4473],
        [-0.0066, -0.1656,  0.2925],
        [-0.2766, -0.1770,  0.4195],
        [ 0.1286, -0.2742,  0.2960],
        [ 0.2211, -0.2445,  0.3558],
        [-0.0276, -0.1316,  0.2276]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.0776, -0.1543,  0.4971],
        [-0.3964, -0.2831,  0.4038],
        [-0.1101, -0.0751,  0.5189],
        [-0.1410, -0.1588,  0.5431],
        [-0.2335, -0.1682,  0.4944],
        [-0.1178, -0.1816,  0.4807],
        [ 0.0687, -0.1642,  0.5610],
        [-0.1514, -0.5600,  0.5158],
        [-0.2011, -0.1505,  0.5323],
        [-0.2102, -0.3127,  0.5199],
        [-0.2226, -0.1435,  0.5209],
        [-0.0395, -0.1885,  0.6084]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>))
pooled_logits tensor([[-0.0948, -0.2763,  0.4908],
        [-0.0409, -0.2225,  0.5198],
        [-0.1255, -0.2961,  0.7704],
        [-0.0771, -0.1445,  0.5096],
        [-0.0521, -0.3257,  0.4728],
        [-0.0901, -0.4557,  0.6067],
        [-0.0013, -0.1984,  0.3398],
        [-0.1527, -0.2117,  0.5164]], device='cuda:0', grad_fn=<CatBackward0>)

batch_loss 1.0391438007354736
tensor([[  101,  4407,  2038,  ...,  2029,  1996,   102],
        [  101,  4372, 26468,  ...,  1010,  2023,   102],
        [  101,  9311,  2103,  ...,  2489,  6067,   102],
        ...,
        [  101,  5876,  1012,  ...,  2041,  2005,   102],
        [  101,  2010,  2388,  ..., 17298, 13900,   102],
        [  101,  2121,  2097,  ...,  6187,  7100,   102]], device='cuda:0')
tensor([1, 2, 1, 1, 2, 2, 1, 2], device='cuda:0')
logits tensor([[-0.4905,  0.2234,  0.4874],
        [-0.4115,  0.1571,  0.5654],
        [-0.6523,  0.5206,  0.4744],
        [-0.5512,  0.2603,  0.6292],
        [-0.6721,  0.0561,  0.6624],
        [-0.4103, -0.0694,  0.5436],
        [-0.8007,  0.5208,  0.5500],
        [-0.6264,  0.3901,  0.4803],
        [-0.6530,  0.3311,  0.3922],
        [-0.4165,  0.2485,  0.3160],
        [-0.3670,  0.1755,  0.4730],
        [-0.4576,  0.4435,  0.4372],
        [-0.6902,  0.4298,  0.3621],
        [-0.5556,  0.5117,  0.2973],
        [-0.5343,  0.3490,  0.3273],
        [-0.5883,  0.3121,  0.3668],
        [-0.3925,  0.0516,  0.6186],
        [-0.3686,  0.3871,  0.5529],
        [-0.6608,  0.4317,  0.5505],
        [-0.4481,  0.4430,  0.3717],
        [-0.6369,  0.2709,  0.4557],
        [-0.5849,  0.4115,  0.4436],
        [-0.6486,  0.2992,  0.3640],
        [-0.4646,  0.1854,  0.7055],
        [-0.4558,  0.2887,  0.5857],
        [-0.6307,  0.5645,  0.6677],
        [-0.4405,  0.3507,  0.7147],
        [-0.4634,  0.2966,  0.7749],
        [-0.4943,  0.1745,  0.6749],
        [-0.6319,  0.3749,  0.6408],
        [-0.5080,  0.2202,  0.7551],
        [-0.5895,  0.0874,  0.8479],
        [-0.4719,  0.2674,  0.4957],
        [-0.5665,  0.2140,  0.6637],
        [-0.5538,  0.2556,  0.4085],
        [-0.5865,  0.2579,  0.4070],
        [-0.4474,  0.3182,  0.7895],
        [-0.8234,  0.3377,  0.2934],
        [-0.8292,  0.2947,  0.5098],
        [-0.4361,  0.2735,  0.4318],
        [-0.4322,  0.2101,  0.5192],
        [-0.3513,  0.0928,  0.6099],
        [-0.6019,  0.2442,  0.1619],
        [-0.3772,  0.2718,  0.3773],
        [-0.5827,  0.2436,  0.2062],
        [-0.5969,  0.3689,  0.3674],
        [-0.5305,  0.3563,  0.3862],
        [-0.5778,  0.3654,  0.2005],
        [-0.4518,  0.4623,  0.4771],
        [-0.7561,  0.4865,  0.3511],
        [-0.4239,  0.2757,  0.3146],
        [-0.5369,  0.5247,  0.3868],
        [-0.6163,  0.3798,  0.1838],
        [-0.6175,  0.4434,  0.3841],
        [-0.4930,  0.2841,  0.4004],
        [-0.4292,  0.2612,  0.5396],
        [-0.5880,  0.3080,  0.4839],
        [-0.7230,  0.4959,  0.2716],
        [-0.6115,  0.4271,  0.3753],
        [-0.4683,  0.2149,  0.5032],
        [-0.5534,  0.2795,  0.5273],
        [-0.5520,  0.1602,  0.4896],
        [-0.4678,  0.3402,  0.5386],
        [-0.4607,  0.3575,  0.5774],
        [-0.5066,  0.3744,  0.4457],
        [-0.5196,  0.4254,  0.5166],
        [-0.4986,  0.2988,  0.4828],
        [-0.3919,  0.2345,  0.4964],
        [-0.6307,  0.3271,  0.4405],
        [-0.6395,  0.2715,  0.4657],
        [-0.5985,  0.4812,  0.4180],
        [-0.4210,  0.3753,  0.4494],
        [-0.5361,  0.4112,  0.5283],
        [-0.5731,  0.3066,  0.5564],
        [-0.4508,  0.3096,  0.5201],
        [-0.7909,  0.3455,  0.3304],
        [-0.5826,  0.3949,  0.4058],
        [-0.4986,  0.2552,  0.3327],
        [-0.6359,  0.2692,  0.4151],
        [-0.6486,  0.2818,  0.4396],
        [-0.5964,  0.2542,  0.4363],
        [-0.5473,  0.2280,  0.3518],
        [-0.3383,  0.3124,  0.4715],
        [-0.5173,  0.2821,  0.3065],
        [-0.3871,  0.2831,  0.4428],
        [-0.4970,  0.2646,  0.2834],
        [-0.3899,  0.3003,  0.3661],
        [-0.6137,  0.1468,  0.5862],
        [-0.7326,  0.3502,  0.8082],
        [-0.5821,  0.2519,  0.6186],
        [-0.6172,  0.1565,  0.8838],
        [-0.4544,  0.1455,  0.7149],
        [-0.6362,  0.2869,  0.6726],
        [-0.6828,  0.0119,  0.7027],
        [-0.6874,  0.2135,  0.8675],
        [-0.6397,  0.5062,  0.2539],
        [-0.5510,  0.3993,  0.2772],
        [-0.4493,  0.2391,  0.5751],
        [-0.5517,  0.4696,  0.5180],
        [-0.6341,  0.2021,  0.6233],
        [-0.5201,  0.0718,  0.7446],
        [-0.4000, -0.0518,  0.6629],
        [-0.4095,  0.0827,  0.7575],
        [-0.4542,  0.0011,  0.7084],
        [-0.5311,  0.0782,  0.5464],
        [-0.6826,  0.0806,  0.5119],
        [-0.7382,  0.2301,  0.5798],
        [-0.7617, -0.0027,  0.6034]], device='cuda:0',
       grad_fn=<AddmmBackward0>)
logits_split (tensor([[-0.4905,  0.2234,  0.4874],
        [-0.4115,  0.1571,  0.5654],
        [-0.6523,  0.5206,  0.4744],
        [-0.5512,  0.2603,  0.6292],
        [-0.6721,  0.0561,  0.6624],
        [-0.4103, -0.0694,  0.5436],
        [-0.8007,  0.5208,  0.5500],
        [-0.6264,  0.3901,  0.4803],
        [-0.6530,  0.3311,  0.3922],
        [-0.4165,  0.2485,  0.3160],
        [-0.3670,  0.1755,  0.4730],
        [-0.4576,  0.4435,  0.4372],
        [-0.6902,  0.4298,  0.3621],
        [-0.5556,  0.5117,  0.2973],
        [-0.5343,  0.3490,  0.3273],
        [-0.5883,  0.3121,  0.3668],
        [-0.3925,  0.0516,  0.6186],
        [-0.3686,  0.3871,  0.5529],
        [-0.6608,  0.4317,  0.5505],
        [-0.4481,  0.4430,  0.3717],
        [-0.6369,  0.2709,  0.4557],
        [-0.5849,  0.4115,  0.4436],
        [-0.6486,  0.2992,  0.3640],
        [-0.4646,  0.1854,  0.7055],
        [-0.4558,  0.2887,  0.5857],
        [-0.6307,  0.5645,  0.6677],
        [-0.4405,  0.3507,  0.7147]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.4634,  0.2966,  0.7749],
        [-0.4943,  0.1745,  0.6749],
        [-0.6319,  0.3749,  0.6408],
        [-0.5080,  0.2202,  0.7551],
        [-0.5895,  0.0874,  0.8479],
        [-0.4719,  0.2674,  0.4957],
        [-0.5665,  0.2140,  0.6637]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.5538,  0.2556,  0.4085],
        [-0.5865,  0.2579,  0.4070],
        [-0.4474,  0.3182,  0.7895],
        [-0.8234,  0.3377,  0.2934],
        [-0.8292,  0.2947,  0.5098]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.4361,  0.2735,  0.4318],
        [-0.4322,  0.2101,  0.5192],
        [-0.3513,  0.0928,  0.6099],
        [-0.6019,  0.2442,  0.1619],
        [-0.3772,  0.2718,  0.3773],
        [-0.5827,  0.2436,  0.2062],
        [-0.5969,  0.3689,  0.3674],
        [-0.5305,  0.3563,  0.3862],
        [-0.5778,  0.3654,  0.2005],
        [-0.4518,  0.4623,  0.4771],
        [-0.7561,  0.4865,  0.3511],
        [-0.4239,  0.2757,  0.3146],
        [-0.5369,  0.5247,  0.3868],
        [-0.6163,  0.3798,  0.1838],
        [-0.6175,  0.4434,  0.3841],
        [-0.4930,  0.2841,  0.4004],
        [-0.4292,  0.2612,  0.5396],
        [-0.5880,  0.3080,  0.4839],
        [-0.7230,  0.4959,  0.2716],
        [-0.6115,  0.4271,  0.3753],
        [-0.4683,  0.2149,  0.5032],
        [-0.5534,  0.2795,  0.5273],
        [-0.5520,  0.1602,  0.4896],
        [-0.4678,  0.3402,  0.5386],
        [-0.4607,  0.3575,  0.5774],
        [-0.5066,  0.3744,  0.4457],
        [-0.5196,  0.4254,  0.5166],
        [-0.4986,  0.2988,  0.4828],
        [-0.3919,  0.2345,  0.4964],
        [-0.6307,  0.3271,  0.4405],
        [-0.6395,  0.2715,  0.4657],
        [-0.5985,  0.4812,  0.4180],
        [-0.4210,  0.3753,  0.4494],
        [-0.5361,  0.4112,  0.5283],
        [-0.5731,  0.3066,  0.5564],
        [-0.4508,  0.3096,  0.5201],
        [-0.7909,  0.3455,  0.3304],
        [-0.5826,  0.3949,  0.4058],
        [-0.4986,  0.2552,  0.3327],
        [-0.6359,  0.2692,  0.4151],
        [-0.6486,  0.2818,  0.4396],
        [-0.5964,  0.2542,  0.4363],
        [-0.5473,  0.2280,  0.3518],
        [-0.3383,  0.3124,  0.4715],
        [-0.5173,  0.2821,  0.3065],
        [-0.3871,  0.2831,  0.4428],
        [-0.4970,  0.2646,  0.2834],
        [-0.3899,  0.3003,  0.3661]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.6137,  0.1468,  0.5862],
        [-0.7326,  0.3502,  0.8082],
        [-0.5821,  0.2519,  0.6186]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.6172,  0.1565,  0.8838],
        [-0.4544,  0.1455,  0.7149],
        [-0.6362,  0.2869,  0.6726],
        [-0.6828,  0.0119,  0.7027],
        [-0.6874,  0.2135,  0.8675]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.6397,  0.5062,  0.2539],
        [-0.5510,  0.3993,  0.2772],
        [-0.4493,  0.2391,  0.5751],
        [-0.5517,  0.4696,  0.5180]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.6341,  0.2021,  0.6233],
        [-0.5201,  0.0718,  0.7446],
        [-0.4000, -0.0518,  0.6629],
        [-0.4095,  0.0827,  0.7575],
        [-0.4542,  0.0011,  0.7084],
        [-0.5311,  0.0782,  0.5464],
        [-0.6826,  0.0806,  0.5119],
        [-0.7382,  0.2301,  0.5798],
        [-0.7617, -0.0027,  0.6034]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>))
pooled_logits tensor([[-0.5411,  0.3165,  0.4961],
        [-0.5322,  0.2336,  0.6933],
        [-0.6481,  0.2928,  0.4817],
        [-0.5298,  0.3211,  0.4160],
        [-0.6428,  0.2496,  0.6710],
        [-0.6156,  0.1629,  0.7683],
        [-0.5479,  0.4036,  0.4061],
        [-0.5702,  0.0769,  0.6376]], device='cuda:0', grad_fn=<CatBackward0>)

batch_loss 0.78419429063797
tensor([[  101,  7112,  5061,  ...,  1012,  2009,   102],
        [  101,  4972,  2066,  ...,  4668,  2124,   102],
        [  101,  2004,  6778,  ...,  4667,  2010,   102],
        ...,
        [  101,  2807,  1010,  ...,  4352,  2033,   102],
        [  101,  2000,  2156,  ..., 12857,  1010,   102],
        [  101,  1524, 23401,  ...,  2979,  1999,   102]], device='cuda:0')
tensor([1, 1, 0, 1], device='cuda:0')
logits tensor([[-0.7485,  0.8151,  0.2422],
        [-0.6535,  0.4409,  0.2428],
        [-0.7330,  0.3815,  0.4619],
        [-0.7503,  0.4970,  0.4677],
        [-0.7697,  0.4468,  0.3542],
        [-0.8897,  0.7538,  0.3447],
        [-0.6302,  0.5297,  0.2791],
        [-0.6844,  0.9028,  0.2532],
        [-0.5261,  0.5287,  0.1778],
        [-0.8924,  0.4315,  0.2706],
        [-0.6563,  0.6322,  0.2696],
        [-0.7695,  0.5317,  0.4738],
        [-0.7486,  0.6901,  0.3134],
        [-0.9527,  0.6307,  0.2409],
        [-0.7222,  0.4978,  0.3714],
        [-0.7503,  0.4825,  0.6826],
        [-0.6243,  0.5129,  0.7331],
        [-0.8516,  0.5995,  0.6092],
        [-0.8613,  0.6690,  0.5855],
        [-0.8495,  0.5971,  0.3317],
        [-0.7935,  0.7278,  0.3152],
        [-0.8614,  0.4778,  0.5307],
        [-0.4538,  0.4482,  0.5070],
        [-0.5640,  0.5677,  0.3126],
        [-0.5659,  0.4909,  0.3195],
        [-0.6290,  0.2935,  0.4238],
        [-0.7057,  0.6850,  0.5808],
        [-0.5325,  0.5294,  0.3584],
        [-0.6929,  0.3577,  0.4620],
        [-0.7018,  0.5207,  0.5981],
        [-0.6712,  0.5792,  0.5468],
        [-0.6299,  0.7185,  0.5494],
        [-0.6582,  0.6648,  0.4896],
        [-0.7101,  0.5912,  0.3678],
        [-0.7354,  0.6801,  0.5350],
        [-0.8590,  0.8761,  0.3512],
        [-0.5885,  0.5002,  0.4037],
        [-0.6785,  0.5891,  0.2393],
        [-0.7152,  0.3758,  0.3765],
        [-0.3821,  0.2447,  0.3339],
        [-0.3683,  0.2075,  0.1892],
        [-0.3407,  0.1189,  0.2795],
        [-0.4164,  0.2275,  0.3083],
        [-0.3914,  0.1552,  0.3399],
        [-0.2823,  0.3237,  0.2362],
        [-0.5417,  0.4426,  0.2074],
        [-0.4728,  0.4710,  0.4665],
        [-0.5923,  0.4534,  0.3542],
        [-0.5464,  0.5010,  0.5709],
        [-0.6998,  0.3540,  0.7011],
        [-0.5365,  0.4818,  0.5218],
        [-0.8720,  0.5647,  0.6432]], device='cuda:0',
       grad_fn=<AddmmBackward0>)
logits_split (tensor([[-0.7485,  0.8151,  0.2422],
        [-0.6535,  0.4409,  0.2428],
        [-0.7330,  0.3815,  0.4619],
        [-0.7503,  0.4970,  0.4677],
        [-0.7697,  0.4468,  0.3542],
        [-0.8897,  0.7538,  0.3447],
        [-0.6302,  0.5297,  0.2791],
        [-0.6844,  0.9028,  0.2532],
        [-0.5261,  0.5287,  0.1778],
        [-0.8924,  0.4315,  0.2706],
        [-0.6563,  0.6322,  0.2696],
        [-0.7695,  0.5317,  0.4738],
        [-0.7486,  0.6901,  0.3134],
        [-0.9527,  0.6307,  0.2409],
        [-0.7222,  0.4978,  0.3714]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.7503,  0.4825,  0.6826],
        [-0.6243,  0.5129,  0.7331],
        [-0.8516,  0.5995,  0.6092],
        [-0.8613,  0.6690,  0.5855],
        [-0.8495,  0.5971,  0.3317],
        [-0.7935,  0.7278,  0.3152],
        [-0.8614,  0.4778,  0.5307],
        [-0.4538,  0.4482,  0.5070],
        [-0.5640,  0.5677,  0.3126],
        [-0.5659,  0.4909,  0.3195],
        [-0.6290,  0.2935,  0.4238],
        [-0.7057,  0.6850,  0.5808],
        [-0.5325,  0.5294,  0.3584],
        [-0.6929,  0.3577,  0.4620],
        [-0.7018,  0.5207,  0.5981],
        [-0.6712,  0.5792,  0.5468],
        [-0.6299,  0.7185,  0.5494],
        [-0.6582,  0.6648,  0.4896],
        [-0.7101,  0.5912,  0.3678],
        [-0.7354,  0.6801,  0.5350],
        [-0.8590,  0.8761,  0.3512],
        [-0.5885,  0.5002,  0.4037],
        [-0.6785,  0.5891,  0.2393],
        [-0.7152,  0.3758,  0.3765]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.3821,  0.2447,  0.3339],
        [-0.3683,  0.2075,  0.1892],
        [-0.3407,  0.1189,  0.2795],
        [-0.4164,  0.2275,  0.3083],
        [-0.3914,  0.1552,  0.3399],
        [-0.2823,  0.3237,  0.2362],
        [-0.5417,  0.4426,  0.2074],
        [-0.4728,  0.4710,  0.4665]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>), tensor([[-0.5923,  0.4534,  0.3542],
        [-0.5464,  0.5010,  0.5709],
        [-0.6998,  0.3540,  0.7011],
        [-0.5365,  0.4818,  0.5218],
        [-0.8720,  0.5647,  0.6432]], device='cuda:0',
       grad_fn=<SplitWithSizesBackward0>))
pooled_logits tensor([[-0.7418,  0.5807,  0.3175],
        [-0.6951,  0.5640,  0.4670],
        [-0.3994,  0.2739,  0.2951],
        [-0.6494,  0.4710,  0.5583]], device='cuda:0', grad_fn=<CatBackward0>)

batch_loss 1.310699462890625
total_loss nan
Training loss: nan
Validation loss: nan

